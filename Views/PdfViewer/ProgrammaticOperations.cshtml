@using Syncfusion.EJ2
@using Syncfusion.EJ2.DropDowns
@using EJ2MVCSampleBrowser.Models
@using Syncfusion.EJ2.Inputs
@{
    ViewBag.Title = "ProgrammaticOperations";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@{
    string serviceUrl = VirtualPathUtility.ToAbsolute("~/api/PdfViewer/");
    string syncfusionLogo = "data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAMwAAADJCAMAAABYMS1zAAAAllBMVEX///8rNXz2kh7b3OXQ0d8jLnlMU4wfK3hYXpH5+fvz8/bv7/SRlbYAAGyLj7GMkLBGToqdoLt4fKS1t8vIydoAGHEXJXUMHnP1hAD1jAD9483+9u7707L4sXSDh6s0PoL3oE76xpr4qV/97d/5vov96NYADW/2m0b7zaX2mTv4t3v5uYT83cL4rms+R4YAAGX2kjBubpsmc7m7AAAEKUlEQVR4nO3c6VbiQBAF4Dai7AiikCbIjuyK7/9ykziTCJLuVLUcu5O5938d8x2kUr0chEAQBEEQpBgJbD/A9RLMVnPbz3C1LHw5Gdh+iCtl7Xue3AxtP8ZVMpReGOlNC/DF2Xt/I+U295rlRHoxZ5ZzzXyWWELNZGn7eX6SYHdiidrA3vYT/SBT3zuPXNt+JOOsv1tCzSKnX5y9vLB4nr/N5TQw8NIwnjzksA3MV6mWqKnlrg0EM4UlmgbyNtu8KC2fs43tx2NlobFEnDzNNmst5bMN5EYzzLKEmlVOmtpgo/8n+/fFyUVTW6ob2ZlG5qCpBbpGdhbf/QXbjmoJNTvHZ5sp3ZI521S7oxY93biqwSga3Wr+/ppjyZptaq3XMjm9Rox569Or3p/Ufz51UtZqdPs2tYf+DTl3CaZdplc11Zj5kWnxtAs2q5hANSlr4+9UTc0mRjMp6zWqfRubmK2ZJdRs0lu0RQyrKX/TTBzDEKZLVeQxfWPdGoY0XSosqpnTFka55KdgVK8aSxizpvzPolxEW8LMLvf7qPHVS2hrn4ypRreAttYADF8y2qMBe615aoTRHgxYfGkOjwYfjnbpbHOc2U/YCwD9EYfVqZm4lZHE32ktttczW05T818yNjTsYkRwcVim+R+bZG1nWMakHpcpLJvMPU3rGLGXtC+OzL6CYh8jlqT5mbKf6QDm/PRfFcq5swsYEewyLaRTZycwYVPLOGyiHc+4gYkW0bpzwMym7BZG7DUaSdwvdwYTzjaqN45PvRfoDkbMD+kan3zI5BBGBIs0jU8/N3cJk3rqLDMmZXcxlws21pm5Y5jvCzY54xz8uYYRy8PpzcbsSdlpjAhO9m2OvLN/9zDRbBNzmLcaHcQks41cMOucxIh91NTkjFvmJkYMVlJKdpWjmOi8k3+3xFWMCAxuljiLMUmxMKP3Z3JeWzFm3KRX6a6bXDfVpw4jyWNxihq6i0BX1rBiVPVrFgRBkIKkVmekZlSV9OaAEwNLtfvxSE9ye7bFKPpIXpovjBxMBs1Ws0dOPxln3p7pVV/jjGSEvCd7ivnNQZNzUA4MMMAAAwwwwAADDDDAAAMMMMAAAwwwwAADDDDAAAMMMMAAAwwwwPzvmOcCYVoFwlRLXUZKcRmnqJtcBBoysnb+lxkRBEEQSuq3jNTjKk6RYVUt/Xl1qXbuK/R04qpHRlE7mQAYRZV2SfHEmtQajN+e7T/GmArnt2fjC8TipnedX6xVYxhTc3mUYIxms/GdSRUHwxg0gQEGGGCAAQYYYIABBhhggAEGGGCAAQYYYIABBhhggAEGGGCAAaaImELdA3i9I6f3henTq5pfNzTK9CqjGxqdt3ty2g8x5qNNrxonmAq96H5sgBH1EiPJPdhbTlVyq4lTVDK41YQgCIIgCIIgSFr+AKg+KPUzaG6DAAAAAElFTkSuQmCC";
}

@section ControlsSection{
    <div>
        <div class="col-lg-9 control-section e-pv-pdfviewer-control-section">
            <div class="content-wrapper">
                <div class="e-pv-flex-container">
                    <label class="e-pv-switchLabel" for="checked">Standalone PDF Viewer</label>
                    <div class="e-message e-pv-render-mode-info">
                        <span class="e-msg-icon e-pv-render-mode-info-icon" title="Turn OFF to render the PDF Viewer as server-backed"></span>
                    </div>
                    <div>
                        @Html.EJS().Switch("checked").Checked(true).Change("change").CssClass("buttonSwitch").Render()
                    </div>
                </div>
                @Html.EJS().PdfViewer("pdfviewer").DocumentPath("https://cdn.syncfusion.com/content/pdf/annotations-v3.pdf").ResourceUrl("https://cdn.syncfusion.com/ej2/23.2.6/dist/ej2-pdfviewer-lib").DocumentLoad("documentLoaded").AnnotationSelect("AnnotationSelectedEvent").AnnotationUnSelect("AnnotationUnSelectedEvent").AnnotationResize("UpdateAnnotationPropertiesToPanel").AnnotationMove("UpdateAnnotationPropertiesToPanel").AnnotationRemove("AnnotationUnSelectedEvent").EnableAnnotationToolbar(false).ToolbarSettings(new Syncfusion.EJ2.PdfViewer.PdfViewerToolbarSettings { ShowTooltip = true, ToolbarItems = new List<string> { "OpenOption", "UndoRedoTool", "PageNavigationTool", "MagnificationTool", "PanTool", "SelectionTool", "CommentTool", "SubmitForm", "FormDesignerEditTool", "FreeTextAnnotationOption", "InkAnnotationOption", "ShapeAnnotationOption", "StampAnnotation", "SignatureOption", "SearchOption", "PrintOption", "DownloadOption" }, FormDesignerToolbarItems = new List<string> { "TextboxTool", "PasswordTool", "CheckBoxTool", "RadioButtonTool", "DropdownTool", "ListboxTool", "DrawSignatureTool", "DeleteTool"} }).Render()
            </div>
        </div>

        <div class="col-lg-3 pv-property-section e-pv-main-panel">
            <div class="e-pv-property-panel-header e-pv-header-panel sb-content-tab-header" id="pv-property-header">
                Properties
                <button class="e-btn e-lib e-flat e-icon-btn e-bigger" id="resetbutton" onclick="resetAnnotationProperties()">
                    <span class="e-icons e-refresh e-btn-icon"></span>
                </button>
            </div>
            <!--Properties panel starts here-->
            <div class="pv-property-panel-content">
                <div class="pdfviewer-text-content"></div>
                <div class="e-pv-pdfviewer-input-title"><span>Annotation Type</span></div>
                <div class="e-pv-input-item">
                    @Html.EJS().DropDownList("annotations").PopupHeight("220px").Index(2).Change("onAnnotationChange").Created("function(args) { onElementCreated('annotations', 'annotationType'); } ").DataSource(
                         (IEnumerable<ProgrammaticOperationsModel>)ViewBag.annotationData).Fields(new DropDownListFieldSettings { Text = "Text", Value = "ID" }).Render()
                </div>
                <div class="e-pv-annot-inner-container" id="StampClicked" style="display: none">
                    <div class="e-pv-pdfviewer-input-title"><span>Stamp Type</span></div>
                    <div class="e-pv-input-item">
                        @Html.EJS().DropDownList("stampTypes").PopupHeight("220px").Index(2).Created("function(args) { onElementCreated('stampTypes', 'stampsType'); } ").Change("function(args) { onPropertiesValueChanges('stampsType',args); }").DataSource(
         (IEnumerable<ProgrammaticOperationsModel>)ViewBag.stampTypeData).Fields(new DropDownListFieldSettings { Text = "Text", Value = "ID" }).Render()
                    </div>
                    <div>
                        <div class="e-pv-pdfviewer-input-title"><span>Comments</span></div>
                        <div class="e-pv-input-item" id="dynamicStampListElement" style="display: none">
                            @Html.EJS().DropDownList("dynamicStamps").PopupHeight("220px").Created("function(args) { onElementCreated('dynamicStamps', 'dynamicStamp'); } ").Change("function(args) { onPropertiesValueChanges('dynamicStamp',args); }").Index(2).DataSource(
    (IEnumerable<ProgrammaticOperationsModel>)ViewBag.dynamicStamps).Fields(new DropDownListFieldSettings { Text = "Text", Value = "ID" }).Render()
                        </div>
                        <div class="e-pv-input-item" id="signHereStampListElement" style="display: none">
                            @Html.EJS().DropDownList("signHereStamps").PopupHeight("220px").Created("function(args) { onElementCreated('signHereStamps', 'signHereStamp'); } ").Change("function(args) { onPropertiesValueChanges('signHereStamp',args); }").Index(2).DataSource(
                            (IEnumerable<ProgrammaticOperationsModel>)ViewBag.signHereStamps).Fields(new DropDownListFieldSettings { Text = "Text", Value = "ID" }).Render()
                        </div>
                        <div class="e-pv-input-item" id="standardBusinessStampListElement" style="display: none">
                            @Html.EJS().DropDownList("standardBusiness").PopupHeight("220px").Created("function(args) { onElementCreated('standardBusiness', 'standardBusinessStamp'); } ").Change("function(args) { onPropertiesValueChanges('standardBusinessStamp',args); }").Index(2).DataSource(
                            (IEnumerable<ProgrammaticOperationsModel>)ViewBag.standardBusiness).Fields(new DropDownListFieldSettings { Text = "Text", Value = "ID" }).Render()
                        </div>
                    </div>
                </div>
                <div class="e-pv-pdfviewer-input-title" id="e-pv-fileuploader" style="display: none;">
                    <div id="dropArea" style="height: auto; overflow: auto">
                        @Html.EJS().Uploader("UploadFiles").DropArea(".control-fluid").AllowedExtensions(".jpg, .jpeg, .png").Multiple(false).AutoUpload(true).Success("onFileSuccess").AsyncSettings(new Syncfusion.EJ2.Inputs.UploaderAsyncSettings { SaveUrl = @Url.Content("https://ej2services.syncfusion.com/production/web-services/api/FileUploader/Save"), RemoveUrl = @Url.Content("https://ej2services.syncfusion.com/production/web-services/api/FileUploader/Remove") }).Template(@"
                <span class='wrapper'>
                    <img class='upload-image' id='uploadedImage' src='" + syncfusionLogo + @"' />
                    <span class='name file-name' id='fileName'>${name}</span>
                    <span class='e-icons e-file-delete-btn' id='removeIcon' onclick='onFileRemove()'></span>
                </span>
            ").Render()
                    </div>
                </div>
                <div class="e-pv-pdfviewer-input-title"><span>Page Number</span></div>
                <div class="e-pv-input-item">
                    @Html.EJS().NumericTextBox("pageNumber").Min(1).Format("n0").Change("function(args) { onPropertiesValueChanges('pageNumber',args); }").Created("function(args) { onElementCreated('pageNumber', 'pageNumber'); } ").Render()
                </div>
                <div class="e-pv-pdfviewer-input-title"><span>Settings:</span></div>
                <div class="e-pv-annot-inner-container" style="padding: 0 0 12px 0px;">
                    <table class="e-pv-annot-inner-table setting-table">
                        <tr id="XYRow" style="display: block;" class="table-row">
                            <td class="left-item">
                                <div class="e-pv-pdfviewer-text-content">
                                    <span>X Position</span>
                                    <div class="e-pv-input-item">
                                        @Html.EJS().NumericTextBox("x-position").Format("###.##").Min(0).Change("function(args) { onPropertiesValueChanges('x',args); }").Created("function(args) { onElementCreated('x-position', 'x'); } ").ShowSpinButton(false).Render()
                                    </div>
                                </div>
                            </td>
                            <td class="right-item">
                                <div class="e-pv-pdfviewer-text-content">
                                    <span>Y Position</span>
                                    <div class="e-pv-input-item">
                                        @Html.EJS().NumericTextBox("y-position").Format("###.##").Min(0).Change("function(args) { onPropertiesValueChanges('y',args); }").Created("function(args) { onElementCreated('y-position', 'y'); } ").ShowSpinButton(false).Render()
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr id="Heightwidthrow" style="display: block;" class="table-row">
                            <td class="left-item">
                                <div class="e-pv-pdfviewer-text-content">
                                    <span>Width</span>
                                    <div class="e-pv-input-item">
                                        @Html.EJS().NumericTextBox("width").Min(0).Format("###.##").Change("function(args) { onPropertiesValueChanges('width',args); }").Created("function(args) { onElementCreated('width', 'width'); } ").ShowSpinButton(false).Render()
                                    </div>
                                </div>
                            </td>
                            <td class="right-item">
                                <div class="e-pv-pdfviewer-text-content">
                                    <span>Height</span>
                                    <div class="e-pv-input-item">
                                        @Html.EJS().NumericTextBox("height").Min(0).Format("###.##").Change("function(args) { onPropertiesValueChanges('height',args); }").Created("function(args) { onElementCreated('height', 'height'); } ").ShowSpinButton(false).Render()
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr id="X1Y1Row" style="display: none;" class="table-row">
                            <td class="left-item">
                                <div class="e-pv-pdfviewer-text-content">
                                    <span>X1 Position</span>
                                    <div class="e-pv-input-item">
                                        @Html.EJS().NumericTextBox("x1-position").Min(0).Format("###.##").Change("function(args) { onPropertiesValueChanges('vertexX1',args); }").Created("function(args) { onElementCreated('x1-position', 'vertexX1'); } ").ShowSpinButton(false).Render()
                                    </div>
                                </div>
                            </td>
                            <td class="right-item">
                                <div class="e-pv-pdfviewer-text-content">
                                    <span>Y1 Position</span>
                                    <div class="e-pv-input-item">
                                        @Html.EJS().NumericTextBox("y1-position").Min(0).Format("###.##").Change("function(args) { onPropertiesValueChanges('vertexY1',args); }").Created("function(args) { onElementCreated('y1-position', 'vertexY1'); } ").ShowSpinButton(false).Render()
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr id="X2Y2Row" style="display: none;" class="table-row">
                            <td class="left-item">
                                <div class="e-pv-pdfviewer-text-content">
                                    <span>X2 Position</span>
                                    <div class="e-pv-input-item">
                                        @Html.EJS().NumericTextBox("x2-position").Min(0).Change("function(args) { onPropertiesValueChanges('vertexX2',args); }").Created("function(args) { onElementCreated('x2-position', 'vertexX2'); } ").Format("###.##").ShowSpinButton(false).Render()
                                    </div>
                                </div>
                            </td>
                            <td class="right-item">
                                <div class="e-pv-pdfviewer-text-content">
                                    <span>Y2 Position</span>
                                    <div class="e-pv-input-item">
                                        @Html.EJS().NumericTextBox("y2-position").Min(0).Change("function(args) { onPropertiesValueChanges('vertexY2',args); }").Created("function(args) { onElementCreated('y2-position', 'vertexY2'); } ").Format("###.##").ShowSpinButton(false).Render()
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr style="display:flex">
                            <td class="left-item">
                                <div class="e-pv-pdfviewer-text-content">
                                    <span>Shape Opacity</span>
                                    <div class="e-pv-input-item">
                                        @Html.EJS().NumericTextBox("shape").Min(0).Max(100).Change("function(args) { onPropertiesValueChanges('opacity',args); }").Created("function(args) { onElementCreated('shape', 'opacity'); } ").Format("###.##").ShowSpinButton(false).Render()
                                    </div>
                                </div>
                            </td>
                            <td class="right-item" id="ColorFillerIstrue" style="display: block;">
                                <div class="e-pv-pdfviewer-text-content">
                                    <span>Fill Color</span>
                                    <div class="e-pv-input-item">
                                        @Html.EJS().ColorPicker("fill-color").Mode(Syncfusion.EJ2.Inputs.ColorPickerMode.Palette).Change("function(args) { onPropertiesValueChanges('fillColor',args); }").Created("function(args) { onElementCreated('fill-color', 'fillColor'); } ").Render()
                                        <ejs-colorpicker id='color-picker'></ejs-colorpicker>
                                    </div>

                                </div>
                            </td>
                        </tr>
                        <tr id="strokeThickness" style="display: block;" class="table-row">
                            <td class="left-item">
                                <div class="e-pv-pdfviewer-text-content">
                                    <span>Stroke Thickness</span>
                                    <div class="e-pv-input-item">
                                        @Html.EJS().NumericTextBox("Stroke").Min(1).Max(12).Format("###.##").Change("function(args) { onPropertiesValueChanges('thickness',args); }").Created("function(args) { onElementCreated('Stroke', 'thickness'); } ").ShowSpinButton(false).Render()
                                    </div>
                                </div>
                            </td>
                            <td class="right-item">
                                <div class="e-pv-pdfviewer-text-content">
                                    <span>Stroke Color</span>
                                    <div class="e-pv-input-item">
                                        @Html.EJS().ColorPicker("stroke-color").Change("function(args) { onPropertiesValueChanges('strokeColor',args); }").Created("function(args) { onElementCreated('stroke-color', 'strokeColor'); } ").Mode(Syncfusion.EJ2.Inputs.ColorPickerMode.Palette).Render()
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </table>
                    <div style="padding: 12px 12px 0 12px;">
                        <table class="e-pv-annot-inner-table e-pv-pdfViewer-coordinate-table e-pv-annot-bounds-list" id="coordinate-table" style="border-collapse: collapse;">
                        </table>
                    </div>
                    <div id="deladdboundsButtons" style="display: none;">
                        <div class="e-pv-annot-button-section" style="padding: 12px 12px 0px 0; border: 0px; font-size: 12px;">
                            @Html.EJS().Button("deleteBounds").Content("Delete").Click("deleteList").IsPrimary(true).CssClass("e-outline").Render()
                            @Html.EJS().Button("addBounds").Click("addBounds").Content("Add Bounds").IsPrimary(true).Render()
                        </div>
                    </div>
                    <div style="padding: 0px 12px 12px 12px; display: none;" id="Line">
                        <div class="e-pv-pdfviewer-input-title"><span>Line Head Start</span></div>
                        <div class="e-pv-input-item">
                            @Html.EJS().DropDownList("lineHeadStart").Index(2).DataSource(
    (IEnumerable<ProgrammaticOperationsModel>)ViewBag.lineHeadStyles).Fields(new DropDownListFieldSettings { Text = "Text", Value = "ID" }).Change("function(args) { onPropertiesValueChanges('lineHeadStartStyle',args); }").Created("function(args) { onElementCreated('lineHeadStart', 'lineHeadStartStyle'); } ").Render()
                        </div>
                        <div class="e-pv-pdfviewer-input-title"><span>Line Head End</span></div>
                        <div class="e-pv-input-item">
                            @Html.EJS().DropDownList("lineHeadEnd").Index(2).DataSource(
    (IEnumerable<ProgrammaticOperationsModel>)ViewBag.lineHeadStyles).Fields(new DropDownListFieldSettings { Text = "Text", Value = "ID" }).Change("function(args) { onPropertiesValueChanges('lineHeadEndStyle',args); }").Created("function(args) { onElementCreated('lineHeadEnd', 'lineHeadEndStyle'); } ").Render()
                        </div>
                        <div class="e-pv-pdfviewer-input-title" id="distance" style="display: none;">
                            <span>Leader Length</span>
                            <div class="e-pv-input-item">
                                @Html.EJS().NumericTextBox("leaderLength").Min(0).Format("###.##").ShowSpinButton(false).Change("function(args) { onPropertiesValueChanges('leaderLength',args); }").Created("function(args) { onElementCreated('leaderLength', 'leaderLength'); } ").Render()
                            </div>
                        </div>
                    </div>
                    <div style="padding: 12px 12px 0 12px;">
                        <table class="e-pv-annot-inner-table e-pv-pdfViewer-coordinate-table e-pv-annot-bounds-list"  style="border-collapse: collapse;">
                        </table>
                    </div>
                    <div id="polygon" style="display: none;">
                        <div class="e-pv-annot-button-section" style="padding: 12px 12px 0px 0; border: 0px; font-size: 12px;">
                            @Html.EJS().Button("deleteVertex").Content("Delete").Click("deleteList").IsPrimary(true).CssClass("e-outline").Render()
                            @Html.EJS().Button("addVertex").Content("Add Vertex").Click("addVertexPoints").IsPrimary(true).Render()
                        </div>
                    </div>
                </div>
            </div>
            <div style="padding: 0 0 0px 0px; display: none;" id="InkAnnoatation">
                <div class="e-pv-pdfviewer-input-title"><span>Ink Annotation</span></div>
                <div class="e-pv-input-item">
                    @Html.EJS().DropDownList("inkData").PopupHeight("220px").Index(2).Change("function(args) { onPropertiesValueChanges('inkAnnotationType',args); }").Created("function(args) { onElementCreated('inkData', 'inkAnnotationType'); } ").DataSource(
    (IEnumerable<ProgrammaticOperationsModel>)ViewBag.inkAnnotationData).Fields(new DropDownListFieldSettings { Text = "Text", Value = "ID" }).Render()
                </div>
            </div>
            <div class="e-pv-pdfviewer-input-title" id="FreeText" style="display: none;"><span>Text Properties:</span></div>
            <div class="e-pv-annot-inner-container" id="FreeTextElement" style="display: none;">
                <div class="e-pv-pdfviewer-text-content" style="margin-top: 0%;">
                    <span>Default Text</span>
                </div>
                <div class="e-pv-input-item">
                    @Html.EJS().TextBox("defaultText").CssClass("e-outline").Change("function(args) { onPropertiesValueChanges('defaultText',args); }").Created("function(args) { onElementCreated('defaultText', 'defaultText'); } ").FloatLabelType(FloatLabelType.Auto).Render()
                </div>
                <div class="e-pv-pdfviewer-input-title"><span>Font Family</span></div>
                <div class="e-pv-input-item">
                    @Html.EJS().DropDownList("fontFamily").PopupHeight("220px").Index(2).Change("function(args) { onPropertiesValueChanges('fontFamily',args); }").Created("function(args) { onElementCreated('fontFamily', 'fontFamily'); } ").DataSource(
    (IEnumerable<ProgrammaticOperationsModel>)ViewBag.fontFamily).Fields(new DropDownListFieldSettings { Text = "Text", Value = "ID" }).Render()
                </div>
                <div class="e-pv-pdfviewer-input-title"><span>Alignment</span></div>
                <div class="e-pv-input-item">
                    @Html.EJS().DropDownList("textAlignment").PopupHeight("220px").Index(2).Change("function(args) { onPropertiesValueChanges('alignment',args); }").Created("function(args) { onElementCreated('textAlignment', 'alignment'); } ").DataSource(
    (IEnumerable<ProgrammaticOperationsModel>)ViewBag.textAlignment).Fields(new DropDownListFieldSettings { Text = "Text", Value = "ID" }).Render()
                </div>
                <div class="e-pv-pdfviewer-input-title"><span>Font Style</span></div>
                <div class="e-pv-input-item">
                    @Html.EJS().DropDownList("fontStyle").PopupHeight("220px").Index(2).Change("function(args) { onPropertiesValueChanges('fontStyle',args); }").Created("function(args) { onElementCreated('fontStyle', 'fontStyle'); } ").DataSource(
    (IEnumerable<ProgrammaticOperationsModel>)ViewBag.fontStyles).Fields(new DropDownListFieldSettings { Text = "Text", Value = "ID" }).Render()
                </div>
                <div class="e-pv-pdfviewer-input-title">
                    <table class="e-pv-annot-inner-table">
                        <tr>
                            <td style="width:50%;padding:0;">
                                <span>Font Size</span>
                                <div class="e-pv-input-item">
                                    @Html.EJS().NumericTextBox("fontSize").Format("n0").ShowSpinButton(false).Change("function(args) { onPropertiesValueChanges('fontSize',args); }").Created("function(args) { onElementCreated('fontSize', 'fontSize'); } ").Render()
                                </div>
                            </td>
                            <td style="padding:0;">
                                <div style="margin-left: 12px;">
                                    <span>Font Color</span>
                                    <div class="e-pv-input-item">
                                        @Html.EJS().ColorPicker("font-color").Mode(Syncfusion.EJ2.Inputs.ColorPickerMode.Palette).Change("function(args) { onPropertiesValueChanges('fontColor',args); }").Created("function(args) { onElementCreated('font-color', 'fontColor'); } ").Render()
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="e-pv-pdfviewer-input-title">
                <table>
                    <tr>
                        <td class="e-pv-check-box-row">
                            @Html.EJS().CheckBox("printChecked").Checked(true).Change("function(args) { onPropertiesValueChanges('isPrint',args); }").Created("function(args) { onElementCreated('printChecked', 'isPrint'); } ").Render()
                        </td>
                        <td class="e-pv-check-box-row"><span>Print Annotation</span></td>
                    </tr>
                    <tr>
                        <td class="e-pv-check-box-row">
                            @Html.EJS().CheckBox("lockChecked").Checked(false).Change("onLockCheckedChange").Created("function(args) { onElementCreated('lockChecked', 'isLocked'); } ").Render()
                        </td>
                        <td class="e-pv-check-box-row"><span>Lock Annotation</span></td>
                    </tr>
                </table>
            </div>
            <div id="allowinstractionsIstrue" style="display: none" ;>
                <div class="e-pv-pdfviewer-input-title e-pv-pdfviewer-text-content"><span>Allow Interactions</span></div>
                <div class="e-pv-input-item">
                    @Html.EJS().MultiSelect("allowInteractions").DataSource((IEnumerable<ProgrammaticOperationsModel>)ViewBag.allowInteractions).Mode(VisualMode.CheckBox).ShowDropDownIcon(true).PopupHeight("350px").Fields(new MultiSelectFieldSettings { Text = "Text", Value = "ID" }).Change("function(args) { onPropertiesValueChanges('allowedInteractions',args); }").Created("function(args) { onElementCreated('allowInteractions', 'allowedInteractions'); } ").Render()
                </div>
            </div>
            <div class="e-pv-pdfviewer-input-title"><span>Add Comments</span></div>
            <div class="e-pv-pdfviewer-input-title"><span>Author</span></div>
            <div class="e-pv-input-item">
                @Html.EJS().TextBox("author").CssClass("e-outline").Change("function(args) { onPropertiesValueChanges('author',args); }").Created("function(args) { onElementCreated('author', 'author'); } ").Render()
            </div>
            <div class="e-pv-pdfviewer-input-title"><span>Content</span></div>
            <div class="e-pv-input-item">
                @Html.EJS().TextBox("comments").CssClass("e-outline").Placeholder("New Comment").Change("function(args) { onPropertiesValueChanges('comment',args); }").Created("function(args) { onElementCreated('comments', 'comment'); } ").Focus("onCommentFocus").Blur("onCommentBlur").Render()
            </div>
            <div class="e-pv-pdfviewer-input-title"><span>Status</span></div>
            <div class="e-pv-input-item">
                @Html.EJS().DropDownList("status").PopupHeight("220px").Index(2).DataSource(
    (IEnumerable<ProgrammaticOperationsModel>)ViewBag.commentStatus).Fields(new DropDownListFieldSettings { Text = "Text", Value = "ID" }).Change("function(args) { onPropertiesValueChanges('state',args); }").Created("function(args) { onElementCreated('status', 'state'); } ").Render()
            </div>
            <div class="e-pv-pdfviewer-input-title">
                <table>
                    <tr>
                        <td class="e-pv-check-box-row">
                            @Html.EJS().CheckBox("replyChecked").Change("onReplyCheckedChange").Created("function(args) { onElementCreated('replyChecked', 'isReply'); } ").Checked(false).Render()
                        </td>
                        <td class="e-pv-check-box-row"><span>Reply</span></td>
                    </tr>
                </table>
            </div>
            <div>
                <div>
                    <div class="e-pv-pdfviewer-input-title" id="replyList"></div>
                    <div class="e-pv-inner-container e-pv-replies" id="repliesContainer" hidden>
                        @Html.EJS().ContextMenu("contextMenu").Select("contextMenuItemSelected").Items(ViewBag.menuItems).Render()
                    </div>
                </div>
                <div class="e-pv-annot-inner-container pdfViewer-checked-Content" style="padding: 10px; display: none;" id="checkedReplybox">
                    <div class="e-pv-pdfviewer-input-title"><span>Author</span></div>
                    <div class="e-pv-input-item">
                        @Html.EJS().TextBox("replyAuthor").CssClass("e-outline").Change("function(args) { onPropertiesValueChanges('replyAuthor',args); }").Created("function(args) { onElementCreated('replyAuthor', 'replyAuthor'); } ").Render()
                    </div>
                    <div class="e-pv-pdfviewer-input-title"><span>Content</span></div>
                    <div class="e-pv-input-item">
                        @Html.EJS().TextBox("replyComment").CssClass("e-outline").Placeholder("Reply Comment").Change("function(args) { onPropertiesValueChanges('replyComment',args); }").Created("function(args) { onElementCreated('replyComment', 'replyComment'); } ").Render()
                    </div>
                    <div class="e-pv-pdfviewer-input-title"><span>Status</span></div>
                    <div class="e-pv-input-item">
                        @Html.EJS().DropDownList("replyStatus").PopupHeight("220px").Index(2).DataSource(
    (IEnumerable<ProgrammaticOperationsModel>)ViewBag.commentStatus).Change("function(args) { onPropertiesValueChanges('replyState',args); }").Created("function(args) { onElementCreated('replyStatus', 'replyState'); } ").Fields(new DropDownListFieldSettings { Text = "Text", Value = "ID" }).Render()
                    </div>
                    <div class="e-pv-annot-button-section" style="padding: 12px 12px 0px 0; border: 0px;">
                        <div id="addreplyButton">
                            @Html.EJS().Button("addReply").Content("Add Reply").Click("updateReply").IsPrimary(true).Render()
                        </div>

                        <div id="updateReplyButton" style="display: none">
                            @Html.EJS().Button("editReply").Click("updateEditReply").Content("Update Reply").IsPrimary(true).Render()
                        </div>
                    </div>
                </div>
            </div>
            <div class="e-pv-property-panel-footer sb-content-tab-header" style="border-bottom:none" id="pv-property-footer">
                <div class="e-pv-annot-button-section" style="padding: 12px 12px 0px 0; border: 0px;">
                    @Html.EJS().Button("updateAnnotation").Content("Update").Click("updateAnnotation").IsPrimary(true).Disabled(true).Render()
                    @Html.EJS().Button("addAnnotation").Content("Add Annotation").Click("addNewAnnotation").Disabled(false).IsPrimary(true).Render()
                </div>
            </div>
        </div>
    </div>
    
}

@section Meta{
    <meta name="description"
          content="This example demonstrates the Default Functionalities in ASP.NET MVC PDF Viewer control. Explore here for more details." />
}

@section ActionDescription{
    <div id="action-description">
        <p>
            This sample demonstrates the creation of various types of annotations in the PDF viewer, including text markup, shapes, measurements, free text, stamps, handwritten signatures, ink, and sticky notes. Additionally, we can customize existing annotations or add new annotations programmatically in the PDF viewer using the provided options.
        </p>
    </div>
}

@section Description{
    <div id="action-description">
        <p>The PDF Viewer component allows the process of programmatically adding or modifying annotations within a PDF document. With the ability to programmatically add any type of annotation using the <a target='_blank' href='https://help.syncfusion.com/cr/aspnetmvc-js2/syncfusion.ej2.pdfviewer.pdfviewer.html#Syncfusion_EJ2_PdfViewer_PdfViewer_AnnotationAdd' aria-label="Navigate to the AnnotationAdd method reference for PdfViewerBase"> AnnotationAdd</a> API and edit existing annotations using the editAnnotation API, users can seamlessly enhance their PDF viewing experience.</p>
        <br />
        <p>The creation of an annotation when clicking the 'Add annotation' button is depending upon the selected properties from the Property panel. To update an existing annotation, users can select the desired annotation, modify its properties, and then click the 'Update' button.</p>
        <br />
        <p>We can programmatically add or update the following types of the annotation in the pdf viewer</p>
        <ul>
            <li><a target='_blank' href='https://ej2.syncfusion.com/aspnetmvc/documentation/pdfviewer/annotation/text-markup-annotation' aria-label="Navigate to the documentation for Text markup annotations in ASP.NET MVC PDF Viewer component"> Text markup annotations </a></li>
            <li><a target='_blank' href='https://ej2.syncfusion.com/aspnetmvc/documentation/pdfviewer/annotation/shape-annotation' aria-label="Navigate to the documentation for Shape annotations in ASP.NET MVC PDF Viewer component"> Shape annotations </a></li>
            <li><a target='_blank' href='https://ej2.syncfusion.com/aspnetmvc/documentation/pdfviewer/annotation/measurement-annotation' aria-label="Navigate to the documentation for Measurements annotation in ASP.NET MVC PDF Viewer component"> Measurements annotation </a></li>
            <li><a target='_blank' href='https://ej2.syncfusion.com/aspnetmvc/documentation/pdfviewer/annotation/free-text-annotation' aria-label="Navigate to the documentation for Free text annotation in ASP.NET MVC PDF Viewer component"> Free text annotation </a></li>
            <li><a target='_blank' href='https://ej2.syncfusion.com/aspnetmvc/documentation/pdfviewer/annotation/stamp-annotation' aria-label="Navigate to the documentation Stamp annotation in ASP.NET MVC PDF Viewer component"> Stamp annotation </a></li>
            <li><a target='_blank' href='https://ej2.syncfusion.com/aspnetmvc/documentation/pdfviewer/annotation/ink-annotation' aria-label="Navigate to the documentation for Ink annotation in ASP.NET MVC PDF Viewer component"> Ink annotation </a></li>
            <li><a target='_blank' href='https://ej2.syncfusion.com/aspnetmvc/documentation/pdfviewer/annotation/sticky-notes-annotation' aria-label="Navigate to the documentation for Sticky notes annotation in ASP.NET MVC PDF Viewer component"> Sticky notes annotation </a></li>
        </ul>
    </div>
    <div id="description">
        <p>
            More information on the PDF Viewer instantiation can be found in this
            <a target="_blank" href="https://ej2.syncfusion.com/aspnetmvc/documentation/pdfviewer/getting-started/">
                documentation section
            </a>.

        </p>

    </div>
}

<style>
    #pdfviewer {
        display: block;
        height: 641px;
    }

    .e-pv-property-panel-header {
        padding-top: 22px; /* Adds space at the top */
        font-size: 15px;
        font-weight: 600;
    }

    .e-pv-header-panel {
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: sticky;
        top: 0px;
        z-index: 2;
        background-color: white;
        border-bottom: 1px solid #D7D7D7;
        padding-bottom: 5px;
        margin-bottom: 16px;
    }

    .e-pv-flex-container {
        display: flex;
        justify-content: flex-end;
        align-items: center;
    }

    .e-pv-render-mode-info {
        background: none;
        border: none;
        padding-left: 0px;
    }

        .e-pv-render-mode-info .e-pv-render-mode-info-icon {
            height: 16px;
            width: 16px;
        }

            .e-pv-render-mode-info .e-pv-render-mode-info-icon::before {
                line-height: normal;
            }

    .e-pv-pdfviewer-control-section {
        border-right: 1px solid #D7D7D7;
    }

    .e-pv-annot-inner-table td {
        white-space: nowrap;
        padding: 12px 12px 0 12px;
        width: 50%;
    }

    .e-pv-main-panel {
        border-left: 1px solid #D7D7D7;
        height: 700px;
        overflow-y: scroll;
        padding-bottom: 0px;
    }

    .e-pv-input-item {
        margin-top: 0px;
    }

    .check-box-row span {
        font-size: 12px;
    }
    
    .e-pv-annot-inner-container {
        margin-top: 15px;
        border: 1px solid rgba(196, 199, 197, 1);
        padding: 12px;
    }

    .e-pv-pdfViewer-coordinate-table {
        border-spacing: 0px;
        border-collapse: collapse;
        width: 100%;
    }

        .e-pv-pdfViewer-coordinate-table td {
            border-top: 1px solid rgba(196, 199, 197, 1);
            border-left: 1px solid rgba(196, 199, 197, 1);
            border-right: 1px solid rgba(196, 199, 197, 1);
            border-bottom: 1px solid rgba(196, 199, 197, 1);
            padding: 5px;
            font-size: 10px;
            text-align: center;
            width: 200px;
        }

    .e-pv-annot-inner-table {
        width: 100%;
        border-collapse: collapse;
        table-layout: fixed;
    }


    .e-pv-property-panel-footer {
        padding: 10px 0px 16px 0px;
        position: sticky;
        bottom: 0;
        background-color: white;
        z-index: 1;
        border-top: 1px solid #D7D7D7;
        margin-top: 16px;
    }

    .e-pv-annot-button-section {
        text-align: center;
        display: flex;
        justify-content: end;
        gap: 12px;
        flex-wrap: wrap-reverse;
    }

    .e-pv-annot-button-section button {
        font-size : 12px;
        padding:8.2px 16px;
    }

    .e-pv-pdfviewer-input-title .e-pv-check-box-row {
        padding: 5px;
        margin-top: 16px;
    }

    .e-pv-fileuploader {
        margin-top: 5px;
    }

    .e-pv-table-items {
        display: flex;
        justify-content: space-evenly;
        flex-wrap: wrap;
        gap: 2px;
    }

    .e-pv-pdfviewer-input-title {
        margin-top: 12px;
        font-size: 12px;
        border-radius: 4px;
    }

    .e-pv-pdfviewer-text-content {
        /* margin-top: 6px; */
        font-size: 12px;
    }

    .e-pv-pdfviewer-table-input-title {
        margin-top: 6px;
        font-size: 11px;
    }

    .e-pv-reply-container {
        display: flex;
        align-items: center;
        gap: 10px;
        justify-content: space-between;
        padding: 12px;
    }

    .e-pv-replies {
        overflow-y: scroll;
        max-height: 180px;
        padding: 0px !important;
        overflow: auto;
    }

    .e-pv-inner-container {
        margin-top: 15px;
        border: 1px solid rgba(196, 199, 197, 1);
        padding: 12px;
    }

    .e-pv-reply-text {
        width: 100%;
        font-size: 12px;
        word-break: break-word;
        white-space: nowrap;
    }

    .e-pv-more-container {
        width: min-content;
    }

    #contextmenutarget {
        padding: 10px;
        position: relative;
        text-align: justify;
        color: gray;
        user-select: none;
    }

    .e-pv-switchLabel {
        font-family: "Segoe UI", "GeezaPro", "DejaVu Serif", sans-serif;
        font-weight: 400;
        line-height: 20px;
        letter-spacing: 0.24px;
        text-align: right;
        font-size: 14px;
    }

    .coordinate-table {
        margin: 20px 0;
    }
    .upload-image {
        width: 80px;
        height: 80px;
        margin: 12px;
        border-radius: 5px;
        border: 1px solid rgba(196, 199, 197, 1);
        padding: 4px;
    }

    .file-name {
        font-size: 14px;
        padding: 0px 5px;
        overflow: hidden;
        text-overflow: ellipsis;
        font-weight: 500;
        width: 90px;
        white-space: nowrap;
    }

    .wrapper {
        display: flex;
        align-items: center;
    }
    .settings-table {
        display: flex;
        flex-direction: column;
    }

    .table-row {
        display: flex;
        width: 100%;
    }

    .left-item, .right-item {
        width: 50%;
    }
    .e-pv-reply-main-container {
        flex-grow: 1;
    }

    body.fluent-dark #pv-property-footer,
    body.fluent-dark #pv-property-header {
        background-color: #1B1A19;
    }

</style>

<script type="text/javascript">
    //function to load annotations in document
    function documentLoaded(e) {
        var viewer = document.getElementById('pdfviewer').ej2_instances[0];
        totalPageCount = viewer.pageCount;
        pageNumberElement.max = totalPageCount;
        if (e.documentName === 'annotations-v3.pdf') {
            viewer.annotation.addAnnotation("Highlight", {
                bounds: [{ x: 97, y: 610, width: 340, height: 14 }],
                pageNumber: 1
            });
            viewer.annotation.addAnnotation("Underline", {
                bounds: [{ x: 97, y: 705, width: 346, height: 14 }],
                pageNumber: 1
            });
            viewer.annotation.addAnnotation("Strikethrough", {
                bounds: [{ x: 97, y: 800, width: 367, height: 14 }],
                pageNumber: 1
            });
            viewer.annotation.addAnnotation("Squiggly", {
                bounds: [{ x: 97, y: 895.5, width: 336, height: 14 }],
                pageNumber: 1
            });
            viewer.annotation.addAnnotation("Line", {
                offset: { x: 200, y: 230 },
                pageNumber: 2,
                vertexPoints: [{ x: 200, y: 230 }, { x: 350, y: 230 }]
            });
            viewer.annotation.addAnnotation("Arrow", {
                offset: { x: 200, y: 370 },
                pageNumber: 2,
                vertexPoints: [{ x: 200, y: 370 }, { x: 350, y: 370 }]
            });
            viewer.annotation.addAnnotation("Rectangle", {
                offset: { x: 200, y: 480 },
                pageNumber: 2,
                width: 150,
                height: 75
            });
            viewer.annotation.addAnnotation("Circle", {
                offset: { x: 200, y: 620 },
                pageNumber: 2,
                width: 90,
                height: 90
            });
            viewer.annotation.addAnnotation("Polygon", {
                offset: { x: 200, y: 800 },
                pageNumber: 2,
                vertexPoints: [{ x: 200, y: 800 }, { x: 242, y: 771 }, { x: 289, y: 799 }, { x: 278, y: 842 }, { x: 211, y: 842 }, { x: 200, y: 800 }]
            });
            viewer.annotation.addAnnotation("Distance", {
                offset: { x: 200, y: 230 },
                pageNumber: 3,
                vertexPoints: [{ x: 200, y: 230 }, { x: 350, y: 230 }]
            });
            viewer.annotation.addAnnotation("Perimeter", {
                offset: { x: 200, y: 350 },
                pageNumber: 3,
                vertexPoints: [{ x: 200, y: 350 }, { x: 285, y: 350 }, { x: 286, y: 412 }]
            });
            viewer.annotation.addAnnotation("Area", {
                offset: { x: 200, y: 500 },
                pageNumber: 3,
                vertexPoints: [{ x: 200, y: 500 }, { x: 288, y: 499 }, { x: 289, y: 553 }, { x: 200, y: 500 }]
            });
            viewer.annotation.addAnnotation("Radius", {
                offset: { x: 200, y: 630 },
                pageNumber: 3,
                width: 90,
                height: 90
            });
            viewer.annotation.addAnnotation("Volume", {
                offset: { x: 200, y: 810 },
                pageNumber: 3,
                vertexPoints: [{ x: 200, y: 810 }, { x: 200, y: 919 }, { x: 320, y: 919 }, { x: 320, y: 809 }, { x: 200, y: 810 }]
            });
            viewer.annotation.addAnnotation("FreeText", {
                offset: { x: 250, y: 150 },
                fontSize: 16,
                fontFamily: "Helvetica",
                pageNumber: 4,
                width: 200,
                height: 40,
                isLock: false,
                defaultText: "Syncfusion"
            });
            viewer.annotation.addAnnotation("Stamp", {
                offset: { x: 200, y: 240 },
                pageNumber: 4
            }, 'Approved');
            viewer.annotation.addAnnotation("Stamp", {
                offset: { x: 200, y: 350 },
                pageNumber: 4
            }, undefined, 'SignHere');
            viewer.annotation.addAnnotation("Stamp", {
                offset: { x: 200, y: 460 },
                pageNumber: 4
            }, undefined, undefined, 'Confidential');
            //The customStampImageSource property contains the stamp image as a base64 string
            viewer.annotation.addAnnotation("Stamp", {
                offset: { x: 200, y: 530 },
                pageNumber: 4,
                customStamps: [
                    {
                        customStampName: "Image",
                        customStampImageSource:
                            "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBwgHBgkIBwgKCgkLDRYPDQwMDRsUFRAWIB0iIiAdHx8kKDQsJCYxJx8fLT0tMTU3Ojo6Iys/RD84QzQ5OjcBCgoKDQwNGg8PGjclHyU3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3N//AABEIAIIAqwMBIgACEQEDEQH/xAAbAAEAAgMBAQAAAAAAAAAAAAAABQYBAwQHAv/EAEEQAAEDAwIEAwYDBAYLAAAAAAECAwQABREGIRIxQVETYXEHFCIygZEVQmIjUnKCJCUzU6HRFhc1c5KisbKzwvD/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhEDEQA/APcaUpQKUpQKUpQKUpQKUpQKVzXGdFtsN2ZPfbYjNJ4nHHDgJFfEK5Q5ttbuUaQhcNxvxUPcklPfflQdlYJxURpe/salthuMNpxEYvuNtKc28VKVcPGB2JB577Vyz7pNuUxy26eWlCml8Mu4OI4kR/0oB2Wvp2T17EJK43qDbloakOqL7m6I7TanHVjOMhCQTjzxgVut89i4Mqdj8Y4VlC0OIKFIUOYKTuOn0INRZZtWkrVLuDpIIHHJlPK4nX1dOJR5kk4A5DYDArVoWbHuVgTPjvF5Ul5xx5zhIBc4jkJyBlI+UHqE0FjpSlApSlApSlApSlApSlApSlApSlArClAczgVmqr7QZLptkezxHi1KvD4ihxKsFprBU6v6IB+pFBTdUKf1uUuFa0WpyUIVoYBx706chchXdKEhZSPLNXXVTsOw6NdjNxkvJS0iLEidHnDhLaPME4z5ZzVHk6kTHu1vTpyE1Jf8L3Oww1ZDaGc4XJXjklXDhP6UlWd63ybrL1rq1mNa1hLcAKEeQgcTbbvyuScHnw5KGweZJPIVRYoDT6okfSlnfWhmCwlu43FGAUKxu2j9atyT+UHvirZBixLZBaiQ2kR4zCMIQnZKRWuz2yLZ7czBgo4GWh13KidypR6qJJJPevOvaFqCXqC4HSGmzxlxQbmvJJAPXwwe2M8R9R3FQc1xde9qOqEW+C44jTFuVxPvtnHvCvI+e4HYZPavV4sdmLGajxmktMtJCENpGAkDkBUbpixRNO2dm3Q0/Cj4lrPNazzUf/uWKlkkEZByKDNKUoFKUoFKUoFKUoFKwahZ2p7dFfMZhTs+ZnHu0FHirB/VjZHqogUE3WOIYzUApzUlwBKUxLOwQCFL/bv467DCEn6qr5i6btk5ht+ZOlXlCxlLkiTxtr8whGG8fy0HdK1FZorymHbjH8dPNlC+NY/lTk1XNTe0m12SCXBFnrkOpX7uh6ItkKUBzPGEnhzjcA1bokKLAZS1BjMx20jAQy2EjHoK85i6PuOovaFNv+pWPDt8J/ggMKUCXktq+BX8HNXmT2G9HLF1trSyW2GrUFgbluT3eCIRIS26tS/iSjwgCcDl35Z3qBlSb/edVcN58e4tojKafiW2MfDQpRBXF8X5UnZPGsq5ZAr0TV2j52oL9Anx7wqCxHYWypLbeXAFH4lNqz8KiNs8x0qy2e1QrNbmYFuZDUdkYSkHOT1JPUk7k0HhsG6u3SHPeisLFwnucE95hOPdmc8DUNhR/OrCR5Ak9NvX9F6cRp20IZIR706AX1I5DA2Qn9KRsPvzJqGmXG0N6pfk3KTEhW2ykBsLKUh2Y4nKlY6lKCAOuVmuafry5T5rFs0vaHQ5JSVIm3FBaQhvq7wfNwjurAPnQZ9pms1WtlVmtDqRcnxwrdK+ERknqT0Vj7DftUN7OA1BilywWx65TnU8PjOAtMsJJzlbhBypXMhPFgADbrF6B0sNSagkzrk+5cbTDeUQ5IHwy3T+bHbYE/y9yK9sabQ02lDSAhCRhKUjAAoIaFaZ8gh++zg8vIKYsUFphB+/Ev8AmONuVTYGBgcqzSoFKUoFKUoFKUoFcV4mOW+2yJbEN6Y40gqTHYGVuHsK7awRmg8rd/1gameJn2n8Ptv5YQn+78f+8cSFLI57AJ8/Oy2eyalhxkRo79htEVI2YgQ1uEH+JSgD68NW/FQ2r7yqxWCTNZR4knZqM1/ePLPChP3IoKRc4l91FqJ3TkfUst2Aygfiz7TDTaEA8mkEAnjPXfAH2NohaPehR2Y8bVF9QwygNttJMcJSkDAAAZru0hY02CyMxFK8SWv9rMfPN55W6lE9d9vQCpughmrLNZVxI1Fc19kupYUn/wAYP+NdQVMjD+khEhsfM40nhUPMp3z9D9K76xQRN/uNxjWj3qwW9F0krKfDa8YISUn83F25VVocf2kXdR/EJlrskZQxiM14ryR5ZJA9c/SrHo973m2SFjPhCfKSzn9wPLCceXbyxUpPmRrdDemTHUMx2UFbjizgJAoPGrbpyJBRPvEi53STfhc34MRCVMrckLSvCT8aFEEjBUQdhUlfbHcrcItuYvc+VqbUBDcpf7PgDSfnJPBxBCQcDBGcnlUn7Om4kly+aonhbPBPkeGiRsIqCEqUcHkSMZ9K5bRqqMbjJ1E5FkTrndFe72m2sAF1MVBI4iD8iVKyoqO2w7VRbrJpRdkt7MGDe56GGhgJ8Njn1P8AZ9fPNd5gXNKQEXt0q7uRmz/0AqFja29znGFq2EmxuqaLzDrkhK2XUj5gF7YUNvhqsX+66nvtqlarsrsmDa7aUvQIqQULuCUqHiLdGPk4c8I686g9BMK8/lu7IxyzCB/9q4bpJkWeP7xd9TQojGeHjdipRk9hlW5/yrF21raoEGM/HcM+TMSDEhwyFuv55YA5DfcnYVx2fTD9wm/jeskMS7goYYhY42IKeyQeajtlR68tqCUjtXWVHakQL/FejupC23PcwsLSeoKVgEVsLWomsFMm1yAM5C2HGir6hSsfY1B6ILViuV50utSWkRpHvNvQTgGO6OLCe/CviB7bVMXjVMC2vCG0VTrk4MtQIeHHleZHJCf1KwKDTcNSqskB2XqSCYjTQ3fYcDzSj0SOSgSdhlP1r50FqherbM5cVQVQwmQtkNlfFxBON8/XB8wa4JNsfUzJ1Jq/wXFQWnH4tvbPEzFCUk8RyPjd2+bkOQ7nHs0iSLRY7dBkKUoy4gnYV8yHFEFxPoCtOPU+VBdaUpQKUpQKqF4H4xry027YxrYyq4yB3cPwND/vV9BVvNVTRf8ATrhqC9KIUJU4x2T2aZHAB/xcZ+tBa6UpQKr+r7lIjRWrdaz/AFrcleBF2z4W3xOq8kDf1wOtSV5ukSz216fOc4GGhk4GSo9EpHVROwHU1DaWtst2S9qG+N8Nzlp4WWSc+6R85S0P1dVHqfSgm7Rb2bTbItvjcXhR2g2kqOVKx1J6k8zVbfP+leoSxkGx2h7LxztJlD8h6FCOZ/VjtXdq25ymWY9ptSv61uSi2yr+4Rj43T5JHLzIrRfHIujtCy/dthFiqQyD8zrqhgZ7qUo/40FJsbL2q7W/YYchUdqdMlXC5SEDJQhbq/CbHTKuEEj90edXfRWi4Gk4yvAUqTMdADsp35ikckj91I7Vn2e6bTpnTUaG5hUtweLJcHVw9PQch6VZ6Dhudot12aQ1dIEWa2hXEhEllLgSe4Cga7OBPBwYHDjGMbYr6pQRNp03ZrM669arVChuu/OphkJJ8tunlUt0pSgjLxYLVew2LtAYleEctqcT8SPRXMfevq0WO12VtTdpgRoiVHKy02AVnuo8z9akaUEBr2O9L0beI8dtx1xyMpIQ2kqUodQANycZrk07JVeLyq4R2HmrZCiiJFW62UF9SilS1AHfhHAgA7b8XlVqIzWMb0GaUpQKUpQc9wkCJAkyVcmWlOH6AmoL2bsqZ0LZi4SXHowfcUeZU58ZP3VUpqNlcjT1zYaGVuRHUJA6koIFcuiZDcnR9lea+RcFkgdvgG1BN1omS48GM7JluoZYaSVuOLOEpSOZJrXdLjEtUF2bcJLceM0MrccOAP8AP0qqR4czWk1qfd2HItgZWFxLe6MLlKHJ14dE9kH1NBttDEjVVzYvtxaUza4547ZCdThSz0kLHQ4+UdAc86tcmQzDjOyJLiW2WUFxxxWwSkDJJ+lbQAOVVPU6vx29xdLsqPgBKZdzIG3ghWEtE9CtX/Kk0GzSTDlwekamnNlL08BMNCs5ZijdAweRVniPqB0qsarce1XrezWlghVsiTCp3B/tFtDicPok8CP4lq7VedSzXYFr8OBwpmyVCPEyPhStQPxEfupAKj5JNVz2eW9t2RIvLJWqGlsQbetXN1pCsuPerjmVZ6gCqLyBis0pUClKUClKUClKUClKUClKUClKUGCMjFVNqw36yeOxpmbb/wAPdcU43GntLPuqlHJCFJO6ckkJI2zzq20oKtE0iZE5q46mnKu8to8TLSmwiMwe6G99/wBSiTVoGwrNcV4uUez2yTcJiiGY7ZWrAyT2AHUk7D1oMXq6R7PapNxlk+FHQVkAZKj0SB1JOAPWozRtqfhW5ybcf9qXJz3qZk54FEbNg9kDCfoT1qGi++alvEGJdGwlq2hE+e0FApTKVu0we4Qk8R7nhNXkcqCs6q0zK1DcIWbkqNbW23ESmWk4ceCsZAV+UEAgnngnvViix2okZqPHbS2y0kIbQkYCUjYAVtpQKUpQKUpQKUpQKUpQKUpQKUpQKUpQKUpQKouv7mwi7W2HJBdZiJNxXHSd5DoUER2gOpU4rI/gq9VxO2i3PXRu6OwmFz2m/DbkKQCtKck4B+p+9BxaTtblqtQEvhM+UtUqatO4U8vdW/YbJHkkVNVgDFZoFKUoFKUoFKUoFKUoFKUoFKUoFKUoFKUoFKUoFKUoFKUoFKUoFKUoFKUoFKUoFKUoFKUoFKUoP//Z"
                    }
                ]
            });
            //The pathData property holds the value of the signature drawn using the ink annotation
            viewer.annotation.addAnnotation("Ink", {
                offset: { x: 250, y: 860 },
                pageNumber: 4,
                width: 200,
                height: 60,
                path: '[{\"command\":\"M\",\"x\":244.83334350585938,\"y\":982.0000305175781},{\"command\":\"L\",\"x\":244.83334350585938,\"y\":982.0000305175781},{\"command\":\"L\",\"x\":250.83334350585938,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":252.83334350585938,\"y\":946.0000305175781},{\"command\":\"L\",\"x\":254.16668701171875,\"y\":940.6667175292969},{\"command\":\"L\",\"x\":256.8333435058594,\"y\":931.3333435058594},{\"command\":\"L\",\"x\":257.5,\"y\":929.3333435058594},{\"command\":\"L\",\"x\":258.8333435058594,\"y\":926.6667175292969},{\"command\":\"L\",\"x\":259.5,\"y\":924.0000305175781},{\"command\":\"L\",\"x\":259.5,\"y\":922.6667175292969},{\"command\":\"L\",\"x\":258.8333435058594,\"y\":922.0000305175781},{\"command\":\"L\",\"x\":258.16668701171875,\"y\":922.0000305175781},{\"command\":\"L\",\"x\":256.8333435058594,\"y\":922.0000305175781},{\"command\":\"L\",\"x\":256.16668701171875,\"y\":922.6667175292969},{\"command\":\"L\",\"x\":254.83334350585938,\"y\":923.3333435058594},{\"command\":\"L\",\"x\":254.16668701171875,\"y\":923.3333435058594},{\"command\":\"L\",\"x\":253.5,\"y\":923.3333435058594},{\"command\":\"L\",\"x\":252.83334350585938,\"y\":925.3333435058594},{\"command\":\"L\",\"x\":252.83334350585938,\"y\":927.3333435058594},{\"command\":\"L\",\"x\":252.83334350585938,\"y\":936.0000305175781},{\"command\":\"L\",\"x\":253.5,\"y\":940.6667175292969},{\"command\":\"L\",\"x\":254.83334350585938,\"y\":944.6667175292969},{\"command\":\"L\",\"x\":260.16668701171875,\"y\":952.0000305175781},{\"command\":\"L\",\"x\":264.16668701171875,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":274.16668701171875,\"y\":958.6667175292969},{\"command\":\"L\",\"x\":278.16668701171875,\"y\":960.0000305175781},{\"command\":\"L\",\"x\":281.5,\"y\":961.3333435058594},{\"command\":\"L\",\"x\":285.5,\"y\":964.6667175292969},{\"command\":\"L\",\"x\":286.8333740234375,\"y\":967.3333435058594},{\"command\":\"L\",\"x\":286.8333740234375,\"y\":970.0000305175781},{\"command\":\"L\",\"x\":282.8333740234375,\"y\":978.6667175292969},{\"command\":\"L\",\"x\":278.16668701171875,\"y\":983.3333435058594},{\"command\":\"L\",\"x\":266.16668701171875,\"y\":991.3333435058594},{\"command\":\"L\",\"x\":259.5,\"y\":993.3333435058594},{\"command\":\"L\",\"x\":252.16668701171875,\"y\":994.0000305175781},{\"command\":\"L\",\"x\":240.83334350585938,\"y\":991.3333435058594},{\"command\":\"L\",\"x\":236.16668701171875,\"y\":988.6667175292969},{\"command\":\"L\",\"x\":230.16668701171875,\"y\":982.6667175292969},{\"command\":\"L\",\"x\":228.83334350585938,\"y\":980.6667175292969},{\"command\":\"L\",\"x\":228.16668701171875,\"y\":978.6667175292969},{\"command\":\"L\",\"x\":228.83334350585938,\"y\":974.6667175292969},{\"command\":\"L\",\"x\":230.16668701171875,\"y\":973.3333435058594},{\"command\":\"L\",\"x\":236.16668701171875,\"y\":971.3333435058594},{\"command\":\"L\",\"x\":240.83334350585938,\"y\":971.3333435058594},{\"command\":\"L\",\"x\":246.16668701171875,\"y\":972.0000305175781},{\"command\":\"L\",\"x\":257.5,\"y\":974.6667175292969},{\"command\":\"L\",\"x\":262.8333435058594,\"y\":976.0000305175781},{\"command\":\"L\",\"x\":269.5,\"y\":977.3333435058594},{\"command\":\"L\",\"x\":276.16668701171875,\"y\":978.6667175292969},{\"command\":\"L\",\"x\":279.5,\"y\":978.0000305175781},{\"command\":\"L\",\"x\":285.5,\"y\":976.6667175292969},{\"command\":\"L\",\"x\":288.16668701171875,\"y\":974.6667175292969},{\"command\":\"L\",\"x\":292.8333740234375,\"y\":969.3333435058594},{\"command\":\"L\",\"x\":293.5,\"y\":966.6667175292969},{\"command\":\"L\",\"x\":294.16668701171875,\"y\":964.0000305175781},{\"command\":\"L\",\"x\":293.5,\"y\":960.0000305175781},{\"command\":\"L\",\"x\":293.5,\"y\":958.0000305175781},{\"command\":\"L\",\"x\":292.8333740234375,\"y\":956.6667175292969},{\"command\":\"L\",\"x\":291.5,\"y\":954.6667175292969},{\"command\":\"L\",\"x\":291.5,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":291.5,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":291.5,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":292.16668701171875,\"y\":954.6667175292969},{\"command\":\"L\",\"x\":292.8333740234375,\"y\":956.0000305175781},{\"command\":\"L\",\"x\":294.16668701171875,\"y\":961.3333435058594},{\"command\":\"L\",\"x\":295.5,\"y\":964.6667175292969},{\"command\":\"L\",\"x\":297.5,\"y\":969.3333435058594},{\"command\":\"L\",\"x\":298.8333740234375,\"y\":970.6667175292969},{\"command\":\"L\",\"x\":301.5,\"y\":970.0000305175781},{\"command\":\"L\",\"x\":304.16668701171875,\"y\":968.6667175292969},{\"command\":\"L\",\"x\":305.5,\"y\":966.0000305175781},{\"command\":\"L\",\"x\":308.8333740234375,\"y\":960.0000305175781},{\"command\":\"L\",\"x\":310.16668701171875,\"y\":957.3333435058594},{\"command\":\"L\",\"x\":310.8333740234375,\"y\":956.0000305175781},{\"command\":\"L\",\"x\":310.8333740234375,\"y\":954.6667175292969},{\"command\":\"L\",\"x\":310.8333740234375,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":311.5,\"y\":956.0000305175781},{\"command\":\"L\",\"x\":312.8333740234375,\"y\":959.3333435058594},{\"command\":\"L\",\"x\":316.16668701171875,\"y\":968.0000305175781},{\"command\":\"L\",\"x\":317.5,\"y\":972.6667175292969},{\"command\":\"L\",\"x\":318.16668701171875,\"y\":977.3333435058594},{\"command\":\"L\",\"x\":319.5,\"y\":983.3333435058594},{\"command\":\"L\",\"x\":319.5,\"y\":986.0000305175781},{\"command\":\"L\",\"x\":319.5,\"y\":988.0000305175781},{\"command\":\"L\",\"x\":318.8333740234375,\"y\":988.0000305175781},{\"command\":\"L\",\"x\":318.16668701171875,\"y\":988.6667175292969},{\"command\":\"L\",\"x\":316.16668701171875,\"y\":987.3333435058594},{\"command\":\"L\",\"x\":314.8333740234375,\"y\":985.3333435058594},{\"command\":\"L\",\"x\":314.16668701171875,\"y\":980.6667175292969},{\"command\":\"L\",\"x\":314.8333740234375,\"y\":974.6667175292969},{\"command\":\"L\",\"x\":316.16668701171875,\"y\":969.3333435058594},{\"command\":\"L\",\"x\":319.5,\"y\":960.6667175292969},{\"command\":\"L\",\"x\":320.16668701171875,\"y\":957.3333435058594},{\"command\":\"L\",\"x\":321.5,\"y\":955.3333435058594},{\"command\":\"L\",\"x\":322.16668701171875,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":322.8333740234375,\"y\":952.6667175292969},{\"command\":\"L\",\"x\":324.16668701171875,\"y\":952.6667175292969},{\"command\":\"L\",\"x\":324.8333740234375,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":326.8333740234375,\"y\":956.0000305175781},{\"command\":\"L\",\"x\":328.16668701171875,\"y\":958.0000305175781},{\"command\":\"L\",\"x\":328.8333740234375,\"y\":960.0000305175781},{\"command\":\"L\",\"x\":329.5,\"y\":962.0000305175781},{\"command\":\"L\",\"x\":330.16668701171875,\"y\":962.0000305175781},{\"command\":\"L\",\"x\":330.16668701171875,\"y\":962.6667175292969},{\"command\":\"L\",\"x\":330.16668701171875,\"y\":962.0000305175781},{\"command\":\"L\",\"x\":330.8333740234375,\"y\":960.0000305175781},{\"command\":\"L\",\"x\":331.5,\"y\":956.0000305175781},{\"command\":\"L\",\"x\":332.8333740234375,\"y\":952.0000305175781},{\"command\":\"L\",\"x\":333.5,\"y\":950.0000305175781},{\"command\":\"L\",\"x\":334.8333740234375,\"y\":948.6667175292969},{\"command\":\"L\",\"x\":335.5,\"y\":948.6667175292969},{\"command\":\"L\",\"x\":336.16668701171875,\"y\":948.6667175292969},{\"command\":\"L\",\"x\":337.5,\"y\":950.6667175292969},{\"command\":\"L\",\"x\":338.8333740234375,\"y\":952.0000305175781},{\"command\":\"L\",\"x\":340.8333740234375,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":341.5,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":342.8333740234375,\"y\":954.6667175292969},{\"command\":\"L\",\"x\":344.8333740234375,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":346.8333740234375,\"y\":952.6667175292969},{\"command\":\"L\",\"x\":349.5,\"y\":949.3333435058594},{\"command\":\"L\",\"x\":350.8333740234375,\"y\":948.0000305175781},{\"command\":\"L\",\"x\":351.5,\"y\":946.6667175292969},{\"command\":\"L\",\"x\":352.8333740234375,\"y\":944.0000305175781},{\"command\":\"L\",\"x\":352.8333740234375,\"y\":943.3333435058594},{\"command\":\"L\",\"x\":354.16668701171875,\"y\":942.0000305175781},{\"command\":\"L\",\"x\":354.8333740234375,\"y\":942.0000305175781},{\"command\":\"L\",\"x\":354.8333740234375,\"y\":942.6667175292969},{\"command\":\"L\",\"x\":354.16668701171875,\"y\":943.3333435058594},{\"command\":\"L\",\"x\":354.16668701171875,\"y\":946.6667175292969},{\"command\":\"L\",\"x\":354.16668701171875,\"y\":950.0000305175781},{\"command\":\"L\",\"x\":355.5,\"y\":956.0000305175781},{\"command\":\"L\",\"x\":356.16668701171875,\"y\":957.3333435058594},{\"command\":\"L\",\"x\":358.16668701171875,\"y\":959.3333435058594},{\"command\":\"L\",\"x\":360.16668701171875,\"y\":958.0000305175781},{\"command\":\"L\",\"x\":364.16668701171875,\"y\":956.0000305175781},{\"command\":\"L\",\"x\":370.8333740234375,\"y\":948.6667175292969},{\"command\":\"L\",\"x\":373.5,\"y\":943.3333435058594},{\"command\":\"L\",\"x\":375.5,\"y\":937.3333435058594},{\"command\":\"L\",\"x\":376.16668701171875,\"y\":933.3333435058594},{\"command\":\"L\",\"x\":376.8333740234375,\"y\":931.3333435058594},{\"command\":\"L\",\"x\":376.8333740234375,\"y\":930.0000305175781},{\"command\":\"L\",\"x\":376.8333740234375,\"y\":929.3333435058594},{\"command\":\"L\",\"x\":376.16668701171875,\"y\":930.0000305175781},{\"command\":\"L\",\"x\":375.5,\"y\":932.0000305175781},{\"command\":\"L\",\"x\":375.5,\"y\":937.3333435058594},{\"command\":\"L\",\"x\":374.8333740234375,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":374.8333740234375,\"y\":960.6667175292969},{\"command\":\"L\",\"x\":375.5,\"y\":966.0000305175781},{\"command\":\"L\",\"x\":377.5,\"y\":974.6667175292969},{\"command\":\"L\",\"x\":378.16668701171875,\"y\":977.3333435058594},{\"command\":\"L\",\"x\":380.8333740234375,\"y\":981.3333435058594},{\"command\":\"L\",\"x\":382.16668701171875,\"y\":982.6667175292969},{\"command\":\"L\",\"x\":383.5,\"y\":982.6667175292969},{\"command\":\"L\",\"x\":387.5,\"y\":982.6667175292969},{\"command\":\"L\",\"x\":389.5,\"y\":980.6667175292969},{\"command\":\"L\",\"x\":392.16668701171875,\"y\":976.6667175292969},{\"command\":\"L\",\"x\":392.8333740234375,\"y\":973.3333435058594},{\"command\":\"L\",\"x\":392.16668701171875,\"y\":970.0000305175781},{\"command\":\"L\",\"x\":388.8333740234375,\"y\":965.3333435058594},{\"command\":\"L\",\"x\":385.5,\"y\":964.0000305175781},{\"command\":\"L\",\"x\":382.8333740234375,\"y\":964.0000305175781},{\"command\":\"L\",\"x\":377.5,\"y\":964.0000305175781},{\"command\":\"L\",\"x\":375.5,\"y\":964.6667175292969},{\"command\":\"L\",\"x\":373.5,\"y\":965.3333435058594},{\"command\":\"L\",\"x\":374.8333740234375,\"y\":963.3333435058594},{\"command\":\"L\",\"x\":376.8333740234375,\"y\":961.3333435058594},{\"command\":\"L\",\"x\":382.16668701171875,\"y\":956.0000305175781},{\"command\":\"L\",\"x\":384.16668701171875,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":387.5,\"y\":950.6667175292969},{\"command\":\"L\",\"x\":388.16668701171875,\"y\":952.0000305175781},{\"command\":\"L\",\"x\":388.16668701171875,\"y\":952.6667175292969},{\"command\":\"L\",\"x\":388.8333740234375,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":388.8333740234375,\"y\":954.6667175292969},{\"command\":\"L\",\"x\":389.5,\"y\":959.3333435058594},{\"command\":\"L\",\"x\":389.5,\"y\":960.6667175292969},{\"command\":\"L\",\"x\":390.16668701171875,\"y\":961.3333435058594},{\"command\":\"L\",\"x\":390.8333740234375,\"y\":960.6667175292969},{\"command\":\"L\",\"x\":393.5,\"y\":958.0000305175781},{\"command\":\"L\",\"x\":396.8333740234375,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":398.16668701171875,\"y\":952.0000305175781},{\"command\":\"L\",\"x\":400.16668701171875,\"y\":949.3333435058594},{\"command\":\"L\",\"x\":400.16668701171875,\"y\":948.6667175292969},{\"command\":\"L\",\"x\":400.8333740234375,\"y\":948.0000305175781},{\"command\":\"L\",\"x\":400.8333740234375,\"y\":947.3333435058594},{\"command\":\"L\",\"x\":401.5,\"y\":948.0000305175781},{\"command\":\"L\",\"x\":402.16668701171875,\"y\":949.3333435058594},{\"command\":\"L\",\"x\":403.5,\"y\":950.6667175292969},{\"command\":\"L\",\"x\":404.8333740234375,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":406.16668701171875,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":407.5,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":410.16668701171875,\"y\":952.0000305175781},{\"command\":\"L\",\"x\":412.16668701171875,\"y\":949.3333435058594},{\"command\":\"L\",\"x\":414.16668701171875,\"y\":944.6667175292969},{\"command\":\"L\",\"x\":414.16668701171875,\"y\":942.0000305175781},{\"command\":\"L\",\"x\":414.16668701171875,\"y\":940.6667175292969},{\"command\":\"L\",\"x\":414.16668701171875,\"y\":938.6667175292969},{\"command\":\"L\",\"x\":414.16668701171875,\"y\":938.0000305175781},{\"command\":\"L\",\"x\":415.5,\"y\":939.3333435058594},{\"command\":\"L\",\"x\":418.8333740234375,\"y\":942.6667175292969},{\"command\":\"L\",\"x\":420.16668701171875,\"y\":945.3333435058594},{\"command\":\"L\",\"x\":421.5,\"y\":946.6667175292969},{\"command\":\"L\",\"x\":422.8333740234375,\"y\":950.0000305175781},{\"command\":\"L\",\"x\":423.5,\"y\":950.6667175292969},{\"command\":\"L\",\"x\":423.5,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":422.8333740234375,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":421.5,\"y\":955.3333435058594},{\"command\":\"L\",\"x\":421.5,\"y\":956.0000305175781},{\"command\":\"L\",\"x\":422.16668701171875,\"y\":954.6667175292969},{\"command\":\"L\",\"x\":422.8333740234375,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":424.8333740234375,\"y\":950.6667175292969},{\"command\":\"L\",\"x\":425.5,\"y\":948.6667175292969},{\"command\":\"L\",\"x\":428.16668701171875,\"y\":945.3333435058594},{\"command\":\"L\",\"x\":428.8333740234375,\"y\":943.3333435058594},{\"command\":\"L\",\"x\":428.8333740234375,\"y\":942.6667175292969},{\"command\":\"L\",\"x\":428.8333740234375,\"y\":943.3333435058594},{\"command\":\"L\",\"x\":428.8333740234375,\"y\":945.3333435058594},{\"command\":\"L\",\"x\":428.8333740234375,\"y\":948.0000305175781},{\"command\":\"L\",\"x\":428.8333740234375,\"y\":950.0000305175781},{\"command\":\"L\",\"x\":429.5,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":430.16668701171875,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":432.8333740234375,\"y\":952.6667175292969},{\"command\":\"L\",\"x\":434.8333740234375,\"y\":950.6667175292969},{\"command\":\"L\",\"x\":437.5,\"y\":948.6667175292969},{\"command\":\"L\",\"x\":440.16668701171875,\"y\":944.6667175292969},{\"command\":\"L\",\"x\":441.5,\"y\":942.6667175292969},{\"command\":\"L\",\"x\":442.16668701171875,\"y\":942.0000305175781},{\"command\":\"L\",\"x\":442.8333740234375,\"y\":941.3333435058594},{\"command\":\"L\",\"x\":442.8333740234375,\"y\":942.0000305175781},{\"command\":\"L\",\"x\":442.8333740234375,\"y\":943.3333435058594},{\"command\":\"L\",\"x\":442.8333740234375,\"y\":944.6667175292969},{\"command\":\"L\",\"x\":442.8333740234375,\"y\":946.0000305175781},{\"command\":\"L\",\"x\":443.5,\"y\":949.3333435058594},{\"command\":\"L\",\"x\":444.16668701171875,\"y\":950.6667175292969},{\"command\":\"L\",\"x\":445.5,\"y\":950.6667175292969},{\"command\":\"L\",\"x\":447.5,\"y\":950.6667175292969},{\"command\":\"L\",\"x\":450.16668701171875,\"y\":948.6667175292969},{\"command\":\"L\",\"x\":452.16668701171875,\"y\":945.3333435058594},{\"command\":\"L\",\"x\":453.5,\"y\":942.6667175292969},{\"command\":\"L\",\"x\":452.8333740234375,\"y\":938.6667175292969},{\"command\":\"L\",\"x\":452.16668701171875,\"y\":937.3333435058594},{\"command\":\"L\",\"x\":450.8333740234375,\"y\":936.6667175292969},{\"command\":\"L\",\"x\":448.8333740234375,\"y\":936.0000305175781},{\"command\":\"L\",\"x\":447.5,\"y\":936.6667175292969},{\"command\":\"L\",\"x\":446.16668701171875,\"y\":937.3333435058594},{\"command\":\"L\",\"x\":445.5,\"y\":938.6667175292969},{\"command\":\"L\",\"x\":445.5,\"y\":939.3333435058594},{\"command\":\"L\",\"x\":446.16668701171875,\"y\":939.3333435058594},{\"command\":\"L\",\"x\":446.8333740234375,\"y\":939.3333435058594},{\"command\":\"L\",\"x\":452.16668701171875,\"y\":937.3333435058594},{\"command\":\"L\",\"x\":454.8333740234375,\"y\":936.6667175292969},{\"command\":\"L\",\"x\":456.8333740234375,\"y\":936.0000305175781},{\"command\":\"L\",\"x\":459.5,\"y\":936.6667175292969},{\"command\":\"L\",\"x\":460.8333740234375,\"y\":937.3333435058594},{\"command\":\"L\",\"x\":461.5,\"y\":938.6667175292969},{\"command\":\"L\",\"x\":462.16668701171875,\"y\":942.0000305175781},{\"command\":\"L\",\"x\":462.16668701171875,\"y\":942.6667175292969},{\"command\":\"L\",\"x\":462.16668701171875,\"y\":944.0000305175781},{\"command\":\"L\",\"x\":462.16668701171875,\"y\":943.3333435058594},{\"command\":\"L\",\"x\":462.16668701171875,\"y\":942.6667175292969},{\"command\":\"L\",\"x\":462.16668701171875,\"y\":941.3333435058594},{\"command\":\"L\",\"x\":462.8333740234375,\"y\":938.6667175292969},{\"command\":\"L\",\"x\":464.16668701171875,\"y\":935.3333435058594},{\"command\":\"L\",\"x\":465.5,\"y\":933.3333435058594},{\"command\":\"L\",\"x\":466.16668701171875,\"y\":932.6667175292969},{\"command\":\"L\",\"x\":467.5,\"y\":933.3333435058594},{\"command\":\"L\",\"x\":469.5,\"y\":935.3333435058594},{\"command\":\"L\",\"x\":470.16668701171875,\"y\":938.6667175292969},{\"command\":\"L\",\"x\":472.8333740234375,\"y\":943.3333435058594},{\"command\":\"L\",\"x\":472.8333740234375,\"y\":944.6667175292969},{\"command\":\"L\",\"x\":474.16668701171875,\"y\":944.6667175292969},{\"command\":\"L\",\"x\":475.5,\"y\":944.0000305175781},{\"command\":\"L\",\"x\":478.16668701171875,\"y\":941.3333435058594},{\"command\":\"L\",\"x\":481.5,\"y\":937.3333435058594},{\"command\":\"L\",\"x\":484.8333740234375,\"y\":934.0000305175781},{\"command\":\"L\",\"x\":488.8333740234375,\"y\":929.3333435058594},{\"command\":\"L\",\"x\":489.5,\"y\":928.0000305175781}]'
            });
            viewer.annotation.addAnnotation("StickyNotes", {
                offset: { x: 300, y: 980 },
                pageNumber: 4,
                isLock: false
            });
        }
        AnnotationUnSelectedEvent();
    }

    class AnnotationBase {
        constructor() {
            this.annotationType = "Rectangle";
            this.pageNumber = 1;
            this.annotationSelected = false;
            this.annotationUnSelected = true;
            this.x = 100;
            this.y = 100;
            this.width = 100;
            this.height = 100;
            this.opacity = 100;
            this.thickness = 1;
            this.fillColor = "#FFFFFF00";
            this.strokeColor = "#FF0000FF";
            this.isPrint = true;
            this.isLocked = false;
            this.isReply = false;
            this.allowedInteractions = ["None"];
            this.author = "Guest";
            this.state = "None";
            this.comment = "New Comment";
            this.replyComments = []; // Assume Comment class is already defined
            this.replyAuthor = "Guest";
            this.replyState = "None";
            this.replyComment = "Reply Comment";
            this.stampsType = "Dynamic";
            this.stampComment = "Approved";
            this.dynamicStamp = "Approved";
            this.signHereStamp = "Accepted";
            this.standardBusinessStamp = "Approved";
            this.modifiedDate = new Date().toDateString();
            this.replyModifiedDate = new Date().toDateString();
            this.bounds = [];
            this.fillColor = "#FFFFFF00";
            this.strokeColor = "#FF0000FF";
            this.vertexX1 = 100;
            this.vertexY1 = 100;
            this.vertexX2 = 200;
            this.vertexY2 = 100;
            this.lineHeadStartStyle = "None";
            this.lineHeadEndStyle = "None";
            this.leaderLength = 0;
            this.vertexPoints = []; // Assume VertexPoint class is already defined
            this.inkAnnotationType = "Syncfusion";
            this.fontFamily = "Helvetica";
            this.fontStyle = "None";
            this.alignment = "Left";
            this.defaultText = "Free text";
            this.fontSize = 16;
            this.fontColor = "#000000FF";
            this.signHereStampList = ["Accepted", "InitialHere", "Rejected", "SignHere", "Witness"];
            this.path = "";
            this.customStampName = "Image";
            this.customStampImageSource = "@syncfusionLogo";
            this.showStampType = true;
            this.showFileUploader = true;
            this.disableInkAnnotField = true;
            this.editReply = false;
            this.replyMenuItems = [
                {
                    text: 'Edit',
                },
                {
                    text: 'Delete',
                }
            ];
        }
    }
    //function for comment properties
    function Comment() {
        this.id = "";
        this.author = "";
        this.note = "";
        this.modifiedDate = "";
        this.state = "";
    }
    //variable to handle annotation functionalities
    var selectedAnnotation = new AnnotationBase();
    var annotationElement;
    var pageNumberElement;
    var stampTypeElement;
    var dynamicStampElement;
    var signHereStampElement;
    var standardBusinessStampElement;
    var pageNumberElement;
    var xPositionElement;
    var yPositionElement;
    var widthElement;
    var heightElement;
    var x1PositionElement;
    var y1PositionElement;
    var x2PositionElement;
    var y2PositionElement;
    var opacityElement;
    var fillColorElement;
    var thicknessElement;
    var strokeColorElement;
    var lineHeadStartElement;
    var lineHeadEndElement;
    var leaderLengthElement;
    var inkDataElement;
    var defaultTextElement;
    var fontFamilyElement;
    var alignmentElement;
    var fontStyleElement;
    var fontSizeElement;
    var fontColorElement;
    var printElement;
    var lockElement;
    var authorElement;
    var commentElement;
    var stateElement;
    var replyElement;
    var replyAuthorElement;
    var replyCommentElement;
    var replyStateElement;
    var uploadElement;
    var isElementLoaded = false;
    var selectedAnnotationType;
    var allowedInteractionsElement;
    var viewer;
    var totalPageCount;

    window.onload = function () {
        //variables to get DOM Element for value manipulation
        annotationElement = document.getElementById('annotations').ej2_instances[0];
        pageNumberElement = document.getElementById('pageNumber').ej2_instances[0];
        stampTypeElement = document.getElementById('stampTypes').ej2_instances[0];
        dynamicStampElement = document.getElementById('dynamicStamps').ej2_instances[0];
        signHereStampElement = document.getElementById('signHereStamps').ej2_instances[0];
        standardBusinessStampElement = document.getElementById('standardBusiness').ej2_instances[0];
        pageNumberElement = document.getElementById('pageNumber').ej2_instances[0];
        xPositionElement = document.getElementById('x-position').ej2_instances[0];
        yPositionElement = document.getElementById('y-position').ej2_instances[0];
        widthElement = document.getElementById('width').ej2_instances[0];
        heightElement = document.getElementById('height').ej2_instances[0];
        x1PositionElement = document.getElementById('x1-position').ej2_instances[0];
        y1PositionElement = document.getElementById('y1-position').ej2_instances[0];
        x2PositionElement = document.getElementById('x2-position').ej2_instances[0];
        y2PositionElement = document.getElementById('y2-position').ej2_instances[0];
        opacityElement = document.getElementById('shape').ej2_instances[0];
        fillColorElement = document.getElementById('fill-color').ej2_instances[0];
        thicknessElement = document.getElementById('Stroke').ej2_instances[0];
        strokeColorElement = document.getElementById('stroke-color').ej2_instances[0];
        lineHeadStartElement = document.getElementById('lineHeadStart').ej2_instances[0];
        lineHeadEndElement = document.getElementById('lineHeadEnd').ej2_instances[0];
        leaderLengthElement = document.getElementById('leaderLength').ej2_instances[0];
        inkDataElement = document.getElementById('inkData').ej2_instances[0];
        defaultTextElement = document.getElementById('defaultText').ej2_instances[0];
        fontFamilyElement = document.getElementById('fontFamily').ej2_instances[0];
        alignmentElement = document.getElementById('textAlignment').ej2_instances[0];
        fontStyleElement = document.getElementById('fontStyle').ej2_instances[0];
        fontSizeElement = document.getElementById('fontSize').ej2_instances[0];
        fontColorElement = document.getElementById('font-color').ej2_instances[0];
        printElement = document.getElementById('printChecked').ej2_instances[0];
        lockElement = document.getElementById('lockChecked').ej2_instances[0];
        authorElement = document.getElementById('author').ej2_instances[0];
        commentElement = document.getElementById('comments').ej2_instances[0];
        stateElement = document.getElementById('status').ej2_instances[0];
        replyElement = document.getElementById('replyChecked').ej2_instances[0];
        replyAuthorElement = document.getElementById('replyAuthor').ej2_instances[0];
        replyCommentElement = document.getElementById('replyComment').ej2_instances[0];
        replyStateElement = document.getElementById('replyStatus').ej2_instances[0];
        uploadElement = document.getElementById('UploadFiles').ej2_instances[0];
        allowedInteractionsElement = document.getElementById('allowInteractions').ej2_instances[0];
        viewer = document.getElementById('pdfviewer').ej2_instances[0];
        isElementLoaded = true;
    }
    //Method to set the element values dynamically 
    function onElementCreated(element, property) {
        if (selectedAnnotation.hasOwnProperty(property)) {
            if (element.includes("Checked")) {
                document.getElementById(element).ej2_instances[0].checked = selectedAnnotation[property];
            }
            else if (property === "comment") {
                document.getElementById(element).ej2_instances[0].placeholder = "New Comment";
            }
            else if (element === 'replyComment') {
                document.getElementById('replyComment').ej2_instances[0].placeholder = "Reply Comment";
            }
            else {
                document.getElementById(element).ej2_instances[0].value = selectedAnnotation[property];
            }
        }
    }
    //Method to set the changed value to property
    function onPropertiesValueChanges(property, event) {
        if (selectedAnnotation.hasOwnProperty(property)) {
            if (property.includes("is")) {
                selectedAnnotation[property] = event.checked;
                if (selectedAnnotation.annotationSelected) {
                    document.getElementById('updateAnnotation').disabled = false;
                }
            }
            else {
                selectedAnnotation[property] = event.value;
                if (property === 'stampsType') {
                    findStampComments(event.value);
                    if (selectedAnnotation.annotationUnSelected && isElementLoaded) {
                        resetAnnotationProperties();
                    }
                }
                else if ((property === 'dynamicStamp' || property === 'signHereStamp' || property === 'standardBusinessStamp') && selectedAnnotation.annotationUnSelected && isElementLoaded) {
                    resetAnnotationProperties();
                }
                if (selectedAnnotation.annotationSelected && event.isInteracted) {
                    if ((property === 'x' || property === 'y') && (selectedAnnotation.annotationType === "Polygon" || selectedAnnotation.annotationType === "Area" || selectedAnnotation.annotationType === 'Volume' || selectedAnnotation.annotationType === 'Perimeter' || selectedAnnotation.annotationType === 'Highlight' || selectedAnnotation.annotationType === 'Underline' || selectedAnnotation.annotationType === 'Strikethrough' || selectedAnnotation.annotationType === 'Squiggly')) {
                        document.getElementById('updateAnnotation').disabled = true;
                    }
                    else if(property === "replyAuthor" || property === "replyComment" || property === "replyState"){
                        document.getElementById('updateAnnotation').disabled = true;
                    }
                    else if ((property === "width" || property === 'height') && (selectedAnnotation.annotationType === "Highlight" || selectedAnnotation.annotationType === "Underline" || selectedAnnotation.annotationType === "Strikethrough" || selectedAnnotation.annotationType === "Squiggly")) {
                        document.getElementById('updateAnnotation').disabled = true;
                    }
                    else {
                        document.getElementById('updateAnnotation').disabled = false;
                    }
                }
                else if ((property === "fontColor" || property === "strokeColor" || property === "fillColor") && selectedAnnotation.annotationSelected) {
                    document.getElementById('updateAnnotation').disabled = false;
                }
            }
        }
    }
    //Method to update annotation properties to property panel
    function updatePropertiesToPanel(collection) {
        var viewer = document.getElementById("pdfviewer").ej2_instances[0];
        selectedAnnotation.annotationType = collection.shapeAnnotationType;
        findStampComments('null');
        if (collection.textMarkupAnnotationType === "Highlight" || collection.textMarkupAnnotationType === "Underline" || collection.textMarkupAnnotationType === "Strikethrough" || collection.textMarkupAnnotationType === "Squiggly") {
            annotationElement.value = collection.textMarkupAnnotationType;
            selectedAnnotation.annotationType = collection.textMarkupAnnotationType;
        }
        else if (collection.shapeAnnotationType === "Square" || collection.shapeAnnotationType === "Rectangle") {
            selectedAnnotation.annotationType = "Rectangle";
            annotationElement.value = selectedAnnotation.annotationType;
        }
        else if (collection.shapeAnnotationType === "Circle" && collection.subject === "Circle" && collection.indent !== "PolygonRadius") {
            selectedAnnotation.annotationType = "Circle";
            annotationElement.value = selectedAnnotation.annotationType;
        }
        else if (collection.shapeAnnotationType === "Polygon" && collection.subject === "Polygon") {
            if (collection.indent === "PolygonVolume") {
                selectedAnnotation.annotationType = "Volume";
            }
            else if (collection.indent === "PolygonDimension") {
                selectedAnnotation.annotationType = "Area";
            }
            else {
                selectedAnnotation.annotationType = "Polygon";
            }
            annotationElement.value = selectedAnnotation.annotationType;
        }
        else if (collection.shapeAnnotationType === "Line" && collection.subject === "Line" && collection.indent !== "LineDimension") {
            selectedAnnotation.annotationType = "Line";
            annotationElement.value = selectedAnnotation.annotationType;
        }
        else if (collection.shapeAnnotationType === "Line" && collection.subject === "Arrow") {
            selectedAnnotation.annotationType = "Arrow";
            annotationElement.value = selectedAnnotation.annotationType;
        }
        else if (collection.shapeAnnotationType === "sticky") {
            selectedAnnotation.annotationType = "StickyNotes";
            annotationElement.value = selectedAnnotation.annotationType;
        }
        else if (collection.shapeAnnotationType === "FreeText") {
            selectedAnnotation.annotationType = "FreeText";
            annotationElement.value = selectedAnnotation.annotationType;
        }
        else if (collection.shapeAnnotationType === "Ink") {
            selectedAnnotation.annotationType = "Ink";
            annotationElement.value = selectedAnnotation.annotationType;
        }
        else if (collection.shapeAnnotationType === "Line" || collection.shapeAnnotationType === "Polyline" || collection.shapeAnnotationType === "Square" || collection.shapeAnnotationType === "Circle" || collection.shapeAnnotationType === "Polygon" && collection.indent) {
            if (collection.indent === "LineDimension") {
                selectedAnnotation.annotationType = "Distance";
                annotationElement.value = selectedAnnotation.annotationType;
            }
            else if (collection.indent === "PolyLineDimension") {
                selectedAnnotation.annotationType = "Perimeter";
                annotationElement.value = selectedAnnotation.annotationType;
            }
            else if (collection.indent === "PolyLineDimension" && collection.subject === "Arrow") {
                selectedAnnotation.annotationType = "Arrow";
                annotationElement.value = selectedAnnotation.annotationType;
            }
            else if (collection.indent === "PolygonDimension") {
                selectedAnnotation.annotationType = "Area";
                annotationElement.value = selectedAnnotation.annotationType;
            }
            else if (collection.indent === "PolygonRadius") {
                selectedAnnotation.annotationType = "Radius";
                annotationElement.value = selectedAnnotation.annotationType;
            }
            else if (collection.indent === "PolygonVolume") {
                selectedAnnotation.annotationType = "Volume";
                annotationElement.value = selectedAnnotation.annotationType;
            }
        }
        else if (collection.shapeAnnotationType === "stamp" && collection.stampAnnotationType === "image") {
            selectedAnnotation.annotationType = "CustomStamp";
            annotationElement.value = selectedAnnotation.annotationType;
        }
        else if (collection.shapeAnnotationType === "stamp" && collection.stampAnnotationType === "path") {
            annotationElement.value = "Stamp";
            selectedAnnotation.annotationType = "stamp";
            if (collection.isDynamicStamp === true) {
                findStampComments("Dynamic");
                selectedAnnotation.stampsType = "Dynamic";
                stampTypeElement.value = "Dynamic";
                dynamicStampElement.value = collection.subject;
            }
            else if (collection.subject === "Accepted" || collection.subject === "InitialHere" || collection.subject === "Rejected" || collection.subject === "SignHere" || collection.subject === "Witness") {
                findStampComments("Sign Here");
                selectedAnnotation.stampsType = "Sign Here";
                stampTypeElement.value = "SignHere";
                signHereStampElement.value = collection.subject;
            }
            else {
                findStampComments("Standard Business");
                selectedAnnotation.stampsType = "Standard Business";
                stampTypeElement.value = "StandardBusiness";
                standardBusinessStampElement.value = collection.subject;
            }
        }
        else {
            selectedAnnotation.annotationType = collection.shapeAnnotationType;
        }
        selectedAnnotation.pageNumber = collection.pageNumber + 1;
        pageNumberElement.value = collection.pageNumber + 1;
        if (selectedAnnotation.annotationType === "Highlight" || selectedAnnotation.annotationType === "Underline" || selectedAnnotation.annotationType === "Strikethrough" || selectedAnnotation.annotationType === "Squiggly" && (collection.annotationAddMode === "Imported Annotation" || collection.annotationAddMode === "Existing Annotation")) {
            selectedAnnotation.width = collection.bounds[0].Width;
            widthElement.value = selectedAnnotation.width;
            selectedAnnotation.height = collection.bounds[0].Height;
            heightElement.value = selectedAnnotation.height;
            selectedAnnotation.x = collection.bounds[0].X;
            xPositionElement.value = selectedAnnotation.x;
            selectedAnnotation.y = collection.bounds[0].Y;
            yPositionElement.value = selectedAnnotation.y;
        }
        else if (selectedAnnotation.annotationType === "Highlight" || selectedAnnotation.annotationType === "Underline" || selectedAnnotation.annotationType === "Strikethrough" || selectedAnnotation.annotationType === "Squiggly" && (collection.annotationAddMode === "UI Drawn Annotation")) {
            selectedAnnotation.width = collection.bounds[0].width;
            widthElement.value = collection.bounds[0].width;
            selectedAnnotation.height = collection.bounds[0].height;
            heightElement.value = collection.bounds[0].height;
            selectedAnnotation.x = collection.bounds[0].left;
            xPositionElement.value = collection.bounds[0].left;
            selectedAnnotation.y = collection.bounds[0].right;
            yPositionElement.value = collection.bounds[0].right;
        }
        else if (selectedAnnotation.annotationType === "FreeText") {
            //for updating the property panel
            selectedAnnotation.width = collection.bounds.width;
            widthElement.value = collection.bounds.width;
            selectedAnnotation.height = collection.bounds.height;
            heightElement.value = collection.bounds.height;
            selectedAnnotation.x = collection.bounds.x ? collection.bounds.x : collection.bounds.left;
            xPositionElement.value = collection.bounds.x ? collection.bounds.x : collection.bounds.left;
            selectedAnnotation.y = collection.bounds.y ? collection.bounds.y : collection.bounds.top;
            yPositionElement.value = collection.bounds.y ? collection.bounds.y : collection.bounds.top;
            selectedAnnotation.bounds = collection.bounds;
            selectedAnnotation.defaultText = collection.dynamicText;
            defaultTextElement.value = collection.dynamicText;
            selectedAnnotation.alignment = collection.textAlign;
            alignmentElement.value = collection.textAlign;
            selectedAnnotation.fontFamily = collection.fontFamily;
            fontFamilyElement.value = collection.fontFamily;
            if (collection.font.isBold) {
                selectedAnnotation.fontStyle = "Bold";
            }
            else if (collection.font.isItalic) {
                selectedAnnotation.fontStyle = "Italic";
            }
            else if (collection.font.isStrikeout) {
                selectedAnnotation.fontStyle = "Strikethrough";
            }
            else if (collection.font.isUnderline) {
                selectedAnnotation.fontStyle = "Underline";
            }
            else {
                selectedAnnotation.fontStyle = "None";
            }
            fontStyleElement.value = selectedAnnotation.fontStyle;
            selectedAnnotation.fontSize = collection.fontSize;
            fontSizeElement.value = collection.fontSize;
            selectedAnnotation.fontColor = collection.fontColor ? (collection.fontColor.includes("rgba") ? rgbaStringToHex(collection.fontColor) : collection.fontColor) : "";
            fontColorElement.value = collection.fontColor ? (collection.fontColor.includes("rgba") ? rgbaStringToHex(collection.fontColor) : collection.fontColor) : "";
        }
        else if (selectedAnnotation.annotationType === "Line" || selectedAnnotation.annotationType === "Arrow" || selectedAnnotation.annotationType === "Distance") {
            selectedAnnotation.vertexX1 = collection.vertexPoints[0].x;
            x1PositionElement.value = collection.vertexPoints[0].x;
            selectedAnnotation.vertexY1 = collection.vertexPoints[0].y;
            y1PositionElement.value = collection.vertexPoints[0].y;
            selectedAnnotation.vertexX2 = collection.vertexPoints[1].x;
            x2PositionElement.value = collection.vertexPoints[1].x;
            selectedAnnotation.vertexY2 = collection.vertexPoints[1].y;
            y2PositionElement.value = collection.vertexPoints[1].y;
            if (collection.lineHeadStartStyle && collection.lineHeadEndStyle) {
                selectedAnnotation.lineHeadStartStyle = collection.lineHeadStartStyle;
                selectedAnnotation.lineHeadEndStyle = collection.lineHeadEndStyle;
            }
            else if (collection.lineHeadStart && collection.lineHeadEnd) {
                selectedAnnotation.lineHeadStartStyle = viewer.annotation.getArrowType(collection.lineHeadStart);
                selectedAnnotation.lineHeadEndStyle = viewer.annotation.getArrowType(collection.lineHeadEnd);
            }
            lineHeadStartElement.value = selectedAnnotation.lineHeadStartStyle;
            lineHeadEndElement.value = selectedAnnotation.lineHeadEndStyle;
            if (selectedAnnotation.annotationType === "Distance") {
                selectedAnnotation.leaderLength = collection.leaderLength;
                leaderLengthElement.value = collection.leaderLength;
            }
        }
        else if (selectedAnnotation.annotationType === "Ink") {
            selectedAnnotation.width = collection.bounds.width;
            widthElement.value = collection.bounds.width;
            selectedAnnotation.height = collection.bounds.height;
            heightElement.value = collection.bounds.height;
            selectedAnnotation.x = collection.bounds.x;
            xPositionElement.value = collection.bounds.x;
            selectedAnnotation.y = collection.bounds.y;
            yPositionElement.value = collection.bounds.y;
        }
        else {
            selectedAnnotation.width = collection.bounds.width;
            widthElement.value = collection.bounds.width;
            selectedAnnotation.height = collection.bounds.height;
            heightElement.value = collection.bounds.height;
            //binding values to x and y positions
            selectedAnnotation.x = collection.bounds.x ? collection.bounds.x : collection.bounds.left;
            selectedAnnotation.y = collection.bounds.y ? collection.bounds.y : collection.bounds.top;
            if (selectedAnnotation.annotationType === "Polygon" || selectedAnnotation.annotationType === "Perimeter" || selectedAnnotation.annotationType === "Area" || selectedAnnotation.annotationType === "Volume") {
                selectedAnnotation.x = collection.vertexPoints[0].x;
                selectedAnnotation.y = collection.vertexPoints[0].y;
            }
            xPositionElement.value = selectedAnnotation.x;
            yPositionElement.value = selectedAnnotation.y;
        }
        selectedAnnotation.opacity = parseInt(collection.opacity * 100, 10);
        opacityElement.value = selectedAnnotation.opacity;
        selectedAnnotation.thickness = collection.thickness;
        thicknessElement.value = collection.thickness;
        selectedAnnotation.strokeColor = collection.strokeColor ? (collection.strokeColor.includes("rgba") ? rgbaStringToHex(collection.strokeColor) : collection.strokeColor) : "";
        strokeColorElement.value = selectedAnnotation.strokeColor;
        selectedAnnotation.isPrint = collection.isPrint;
        printElement.checked = collection.isPrint;
        selectedAnnotation.isLocked = collection.isLocked;
        lockElement.checked = collection.isLocked;
        if (collection.isLocked) {
            document.getElementById('allowinstractionsIstrue').style.display = "block";
            selectedAnnotation.allowedInteractions = collection.allowedInteractions;
            allowedInteractionsElement.value = collection.allowedInteractions;
        }
        else {
            document.getElementById('allowinstractionsIstrue').style.display = "none";
            selectedAnnotation.allowedInteractions = collection.allowedInteractions;
            allowedInteractionsElement.value = collection.allowedInteractions;
        }
        if (selectedAnnotation.annotationType === "Highlight" || selectedAnnotation.annotationType === "Underline" || selectedAnnotation.annotationType === "Strikethrough" || selectedAnnotation.annotationType === "Squiggly") {
            selectedAnnotation.fillColor = collection.color ? (collection.color.includes("rgba") ? rgbaStringToHex(collection.color) : collection.color) : "";
            fillColorElement.value = collection.color ? (collection.color.includes("rgba") ? rgbaStringToHex(collection.color) : collection.color) : "";
        }
        else {
            if (selectedAnnotation.annotationType === "Ink" && !collection.fillColor) {
                collection.fillColor = "#ffffff00";
            }
            selectedAnnotation.fillColor = collection.fillColor ? (collection.fillColor.includes("rgba") ? rgbaStringToHex(collection.fillColor) : collection.fillColor) : "";
            fillColorElement.value = collection.fillColor ? (collection.fillColor.includes("rgba") ? rgbaStringToHex(collection.fillColor) : collection.fillColor) : "";

            selectedAnnotation.strokeColor = collection.strokeColor ? (collection.strokeColor.includes("rgba") ? rgbaStringToHex(collection.strokeColor) : collection.strokeColor) : "";
            strokeColorElement.value = collection.strokeColor ? (collection.strokeColor.includes("rgba") ? rgbaStringToHex(collection.strokeColor) : collection.strokeColor) : "";
        }
        selectedAnnotation.author = collection.author;
        authorElement.value = collection.author;
        selectedAnnotation.comment = collection.note;
        commentElement.placeholder = "";
        commentElement.value = collection.note;
        selectedAnnotation.state = collection.state;
        stateElement.value = collection.state;
        //for updating comments
        selectedAnnotation.author = collection.author;
        authorElement.value = collection.author;
        selectedAnnotation.comment = collection.note;
        if (collection.note) {
            commentElement.value = collection.note;
        }
        else {
            commentElement.value = "";
        }
        selectedAnnotation.state = collection.state;
        stateElement.value = collection.state;
        selectedAnnotation.replyComments = [];
        if (collection.comments.length > 0) {
            for (var i = 0; i < collection.comments.length; i++) {
                var reply = new Comment();
                reply.id = collection.comments[i].annotName;
                reply.author = collection.comments[i].author;
                reply.note = collection.comments[i].note;
                reply.modifiedDate = formatCurrentDate(new Date(collection.comments[i].modifiedDate));
                reply.state = collection.comments[i].state;
                selectedAnnotation.replyComments.push(reply);
            }
        }
        if (collection.comments.length > 0) {
            selectedAnnotation.isReply = true;
            replyElement.checked = selectedAnnotation.isReply;
            displayReplies();
            document.getElementById("checkedReplybox").style.display = "block";
        }
        else {
            document.getElementById('repliesContainer').style.display = "none";
        }
        if (selectedAnnotation.annotationType === 'Volume' || selectedAnnotation.annotationType === 'Area' || selectedAnnotation.annotationType === 'Polygon' || selectedAnnotation.annotationType === 'Perimeter') {
            selectedAnnotation.vertexPoints = collection.vertexPoints;
            generateTable();
        }
        else if (selectedAnnotation.annotationType === "Highlight" || selectedAnnotation.annotationType === "Underline" || selectedAnnotation.annotationType === "Strikethrough" || selectedAnnotation.annotationType === "Squiggly") {
            selectedAnnotation.bounds = collection.bounds;
            generateTable();
        }
    }

    //Function to generate unique for replyComment
    function generateRandomId() {
        return 'id-' + Math.random().toString(36).substr(2, 9) + '-' + Date.now().toString(36);
    }
    //Function to format the date
    function formatCurrentDate(date) {
        var options = {
            month: 'short',
            day: '2-digit',
            hour: '2-digit',
            minute: '2-digit',
            hour12: true,
        };
        return date.toLocaleString('en-US', options).replace(',', '');
    }

    function updateAnnotationComment(currentAnnotation) {
        var viewer = document.getElementById('pdfviewer').ej2_instances[0];
        currentAnnotation.author = selectedAnnotation.author;
        let shapeType = currentAnnotation.indent ? currentAnnotation.indent : "";
        if (shapeType != "LineDimension" && shapeType != "PolyLineDimension" && shapeType != "PolygonDimension" && shapeType != "PolygonRadius" && shapeType != "PolygonVolume") {
            currentAnnotation.note = selectedAnnotation.comment;
        }
        currentAnnotation.setState = selectedAnnotation.setState;
        viewer.annotation.editAnnotation(currentAnnotation);
    }
    //Method to reset annotation properties
    function resetAnnotationProperties() {
        selectedAnnotation.vertexPoints = [];
        selectedAnnotation.bounds = [];
        var shapeAnnotation = selectedAnnotation.annotationType;
        clearTable();
        if (!selectedAnnotation.annotationSelected) {
            if (shapeAnnotation === "Arrow" || shapeAnnotation === "Distance") {
                selectedAnnotation.lineHeadStartStyle = "Arrow";
                selectedAnnotation.lineHeadEndStyle = "Arrow";
                if (shapeAnnotation === "Distance") {
                    selectedAnnotation.leaderLength = 0;
                }
            }
            else if (shapeAnnotation === "Perimeter") {
                selectedAnnotation.lineHeadStartStyle = "OpenArrow";
                selectedAnnotation.lineHeadEndStyle = "OpenArrow";
            }
            else {
                selectedAnnotation.lineHeadStartStyle = "None";
                selectedAnnotation.lineHeadEndStyle = "None";
            }
            if (shapeAnnotation === "Rectangle" || shapeAnnotation === "Circle" || shapeAnnotation === "Radius") {
                selectedAnnotation.width = 100;
                selectedAnnotation.height = 100;
            }
            else if (shapeAnnotation === "Ink") {
                selectedAnnotation.width = 150;
                selectedAnnotation.height = 60;
                selectedAnnotation.fillColor = "ffffff00";
            }
            else if (shapeAnnotation === "FreeText") {
                selectedAnnotation.width = 150;
                selectedAnnotation.height = 26.5;
                selectedAnnotation.defaultText = "Free Text";
                selectedAnnotation.fontFamily = "Helvetica";
                selectedAnnotation.fontStyle = "None";
                selectedAnnotation.alignment = "Left";
                selectedAnnotation.fontSize = 16;
                selectedAnnotation.fontColor = "#000000";
            }
            else if (shapeAnnotation === "StickyNotes") {
                selectedAnnotation.width = 30;
                selectedAnnotation.height = 30;
            }
            else if (shapeAnnotation === "Stamp" || shapeAnnotation === "stamp") {
                if (selectedAnnotation.stampsType === "Dynamic") {
                    document.getElementById('StampClicked').style.display = 'block';
                    findStampComments("Dynamic");
                    selectedAnnotation.width = 140;
                    selectedAnnotation.height = 55;
                }
                else if (selectedAnnotation.stampsType === "SignHere" || selectedAnnotation.stampsType === "Sign Here") {
                    document.getElementById('StampClicked').style.display = 'block';
                    findStampComments("SignHere");
                    for (var i = 0; i < selectedAnnotation.signHereStampList.length; i++) {
                        var stamp = selectedAnnotation.signHereStampList[i];
                        if (stamp === signHereStampElement.itemData.ID) {
                            switch (stamp) {
                                case "SignHere":
                                    {
                                        selectedAnnotation.width = 110;
                                        selectedAnnotation.height = 30;
                                        break;
                                    }
                                case "Witness":
                                    {
                                        selectedAnnotation.width = 130;
                                        selectedAnnotation.height = 30;
                                        break;
                                    }
                                case "InitialHere":
                                    {
                                        selectedAnnotation.width = 90;
                                        selectedAnnotation.height = 30;
                                        break;
                                    }
                                case "Accepted":
                                case "Rejected":
                                    {
                                        selectedAnnotation.width = 35;
                                        selectedAnnotation.height = 35;
                                        break;
                                    }
                            }
                        }
                    }
                }
                else if (selectedAnnotation.stampsType === "StandardBusiness" || selectedAnnotation.stampsType === "Standard Business") {
                    document.getElementById('StampClicked').style.display = 'block';
                    findStampComments("StandardBusiness");
                    switch (selectedAnnotation.standardBusinessStamp) {
                        case "Final":
                        case "Draft":
                            {
                                selectedAnnotation.width = 110;
                                break;
                            }
                        case "Void":
                            {
                                selectedAnnotation.width = 100;
                                break;
                            }
                        default:
                            {
                                selectedAnnotation.width = 130;
                                break;
                            }
                    }
                    selectedAnnotation.height = 30;
                }
            }
            else if (shapeAnnotation === "CustomStamp") {
                selectedAnnotation.width = 100;
                selectedAnnotation.height = 100;
            }
            else if (shapeAnnotation === "Highlight" || shapeAnnotation === "Underline" || shapeAnnotation === "Strikethrough" || shapeAnnotation === "Squiggly") {
                selectedAnnotation.width = 100;
                selectedAnnotation.height = 14;
            }
            else {
                selectedAnnotation.width = 0;
                selectedAnnotation.height = 0;
            }
            selectedAnnotation.x = 100;
            selectedAnnotation.y = 100;
            selectedAnnotation.author = "Guest";
            selectedAnnotation.comment = "";
            commentElement.placeholder = "New Comment";
            selectedAnnotation.state = "None";
            selectedAnnotation.isPrint = true;
            selectedAnnotation.isLocked = false;
            selectedAnnotation.isReply = false;
            document.getElementById('repliesContainer').style.display = "none";
            document.getElementById('checkedReplybox').style.display = "none";
            document.getElementById('allowinstractionsIstrue').style.display = 'none';
            document.getElementById('replyList').style.display = "none";
            selectedAnnotation.allowedInteractions = ["None"];
            selectedAnnotation.strokeColor = "#FF0000";
            if (selectedAnnotation.annotationType === "FreeText") {
                selectedAnnotation.strokeColor = "#FFFFFF00";
            }
            selectedAnnotation.fillColor = "#00000000";
            if (selectedAnnotation.annotationType === "Highlight") {
                selectedAnnotation.fillColor = "#ffff00";
            }
            else if (selectedAnnotation.annotationType === "Underline") {
                selectedAnnotation.fillColor = "#00ff00";
            }
            else if (selectedAnnotation.annotationType === "Strikethrough") {
                selectedAnnotation.fillColor = "#ff0000";
            }
            else if (selectedAnnotation.annotationType === "Squiggly") {
                selectedAnnotation.fillColor = "#ff0000";
            }
            selectedAnnotation.opacity = 100;
            selectedAnnotation.thickness = 1;
            selectedAnnotation.replyAuthor = "Guest";
            selectedAnnotation.replyState = "None";
            selectedAnnotation.replyComment = "";
            replyCommentElement.placeholder = "Reply Comment";
            selectedAnnotation.replyComments = [];
            if (shapeAnnotation === "Highlight" || shapeAnnotation === "Underline" || shapeAnnotation === "Strikethrough" || shapeAnnotation === "Squiggly" || shapeAnnotation === "FreeText" || shapeAnnotation === "Polygon" || shapeAnnotation === "Perimeter" || shapeAnnotation === "Area" || shapeAnnotation === "Volume") {
                selectedAnnotation.x = 10;
                selectedAnnotation.y = 10;
            }
            selectedAnnotation.vertexX1 = 100;
            selectedAnnotation.vertexY1 = 100;
            selectedAnnotation.vertexX2 = 200;
            selectedAnnotation.vertexY2 = 100;
            selectedAnnotation.allowedInteractions = ["None"];
            uploadElement.clearAll();
        }
        //Binding pageNumber property
        pageNumberElement.value = selectedAnnotation.pageNumber;
        //Binding the properties of properties panel
        xPositionElement.value = selectedAnnotation.x;
        yPositionElement.value = selectedAnnotation.y;
        widthElement.value = selectedAnnotation.width;
        heightElement.value = selectedAnnotation.height;
        fillColorElement.value = selectedAnnotation.fillColor;
        strokeColorElement.value = selectedAnnotation.strokeColor;
        opacityElement.value = selectedAnnotation.opacity;
        thicknessElement.value = selectedAnnotation.thickness;
        if (shapeAnnotation === "Line" || shapeAnnotation === "Arrow" || shapeAnnotation === "Distance") {
            x1PositionElement.value = selectedAnnotation.vertexX1;
            y1PositionElement.value = selectedAnnotation.vertexY1;
            x2PositionElement.value = selectedAnnotation.vertexX2;
            y2PositionElement.value = selectedAnnotation.vertexY2;
            lineHeadStartElement.value = selectedAnnotation.lineHeadStartStyle;
            lineHeadEndElement.value = selectedAnnotation.lineHeadEndStyle;
            if (shapeAnnotation === "Distance") {
                leaderLengthElement.value = selectedAnnotation.leaderLength;
            }
        }
        //Binding properties of comment panel
        authorElement.value = selectedAnnotation.author;
        commentElement.value = selectedAnnotation.comment;
        stateElement.value = selectedAnnotation.state;
        //Binding print and lock properties
        printElement.checked = selectedAnnotation.isPrint;
        lockElement.checked = selectedAnnotation.isLocked;
        allowedInteractionsElement.value = selectedAnnotation.allowedInteractions;
        //Binding properties of reply comments panel
        replyElement.checked = selectedAnnotation.isReply;
        replyAuthorElement.value = selectedAnnotation.replyAuthor;
        replyCommentElement.value = selectedAnnotation.replyComment;
        replyStateElement.value = selectedAnnotation.replyState;
        //Binding properties for text properties panel
        if (shapeAnnotation === "FreeText") {
            defaultTextElement.value = selectedAnnotation.defaultText;
            fontFamilyElement.value = selectedAnnotation.fontFamily;
            alignmentElement.value = selectedAnnotation.alignment;
            fontStyleElement.value = selectedAnnotation.fontStyle
            fontSizeElement.value = selectedAnnotation.fontSize;
            fontColorElement.value = selectedAnnotation.fontColor;
        }
    }
    //Method to convert RGBA color code to HEXA code
    function rgbaStringToHex(rgba) {
        var rgbaRegex = /^rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/;
        var match = rgba.match(rgbaRegex);
        if (match) {
            var r = parseInt(match[1], 10);
            var g = parseInt(match[2], 10);
            var b = parseInt(match[3], 10);
            var a = (Number)(parseFloat(match[4]) * 255);
            var redHex = ('0' + r.toString(16)).slice(-2);
            var greenHex = ('0' + g.toString(16)).slice(-2);
            var blueHex = ('0' + b.toString(16)).slice(-2);
            var alphaHex = ('0' + a.toString(16).slice(-2));
            if (redHex === "00" && greenHex === "00" && blueHex === "00") {
                return "#".concat(redHex).concat(greenHex).concat(blueHex).concat(alphaHex);
            }
            else {
                return "#".concat(redHex).concat(greenHex).concat(blueHex);
            }
        }
        else {
            return null;
        }
    }
    //Method triggered when an annotation is selected
    function AnnotationSelectedEvent(AnnotationSelectEventArgs) {
        var viewer = document.getElementById('pdfviewer').ej2_instances[0];
        viewer.enableCommentPanel = true;
        CurrentUpdateAnnotationID = AnnotationSelectEventArgs.annotationId;
        var viewer = document.getElementById('pdfviewer').ej2_instances[0]
        if (viewer && viewer.annotationCollection) {
            for (let index = 0; index < viewer.annotationCollection.length; index++) {
                if (viewer.annotationCollection[index].annotationId === CurrentUpdateAnnotationID) {
                    updatePropertiesToPanel(viewer.annotationCollection[index]);
                    break;
                }
            }
        }
        selectedAnnotation.annotationSelected = true;
        selectedAnnotation.annotationUnSelected = false;
        viewControl();
    }
    //Method triggered when an annotation is unselected
    function AnnotationUnSelectedEvent(AnnotationUnSelectedEventArgs) {
        var viewer = document.getElementById('pdfviewer').ej2_instances[0];
        viewer.enableCommentPanel = false;
        selectedAnnotation.annotationSelected = false;
        selectedAnnotation.annotationUnSelected = true;
        resetAnnotationProperties();
        viewControl();
    }
    //Method to update the property elements based on the type of annotation selected
    function onAnnotationChange() {
        var pdfviewer = document.getElementById('pdfviewer').ej2_instances[0];
        var listObj = document.getElementById('annotations').ej2_instances[0];
        selectedAnnotationType = listObj.value;
        selectedAnnotation.annotationType = selectedAnnotationType;
        //this.selectedAnnotation.AnnotationType = this.dropDownList.value.toString();
        switch (selectedAnnotationType) {
            case 'Highlight':
            case 'Underline':
            case 'Strikethrough':
            case 'Squiggly':
                {
                    document.getElementById('strokeThickness').style.display = 'none';
                    document.getElementById('deladdboundsButtons').style.display = 'block';
                    document.getElementById('ColorFillerIstrue').style.display = 'block';
                    document.getElementById('XYRow').style.display = 'flex';
                    document.getElementById('Heightwidthrow').style.display = 'flex';
                    document.getElementById('X1Y1Row').style.display = 'none';
                    document.getElementById('X2Y2Row').style.display = 'none';
                    document.getElementById('Line').style.display = 'none';
                    document.getElementById('polygon').style.display = 'none';
                    document.getElementById('InkAnnoatation').style.display = 'none';
                    document.getElementById('StampClicked').style.display = 'none';
                    document.getElementById('FreeText').style.display = 'none';
                    document.getElementById('FreeTextElement').style.display = 'none';
                    document.getElementById('e-pv-fileuploader').style.display = 'none';
                    document.getElementById('allowinstractionsIstrue').style.display = 'none';
                    break;
                }
            case 'Line':
            case 'Arrow':
                {
                    document.getElementById('strokeThickness').style.display = 'flex';
                    document.getElementById('deladdboundsButtons').style.display = 'none';
                    document.getElementById('ColorFillerIstrue').style.display = 'block';
                    document.getElementById('XYRow').style.display = 'none';
                    document.getElementById('Heightwidthrow').style.display = 'none';
                    document.getElementById('X1Y1Row').style.display = 'flex';
                    document.getElementById('X2Y2Row').style.display = 'flex';
                    document.getElementById('Line').style.display = 'block';
                    document.getElementById('distance').style.display = 'none';
                    document.getElementById('polygon').style.display = 'none';
                    document.getElementById('InkAnnoatation').style.display = 'none';
                    document.getElementById('StampClicked').style.display = 'none';
                    document.getElementById('FreeText').style.display = 'none';
                    document.getElementById('FreeTextElement').style.display = 'none';
                    document.getElementById('e-pv-fileuploader').style.display = 'none';
                    document.getElementById('allowinstractionsIstrue').style.display = 'none';
                    break;
                }
            case 'Rectangle':
            case 'Circle':
            case 'Radius':
                {
                    document.getElementById('strokeThickness').style.display = 'flex';
                    document.getElementById('deladdboundsButtons').style.display = 'none';
                    document.getElementById('ColorFillerIstrue').style.display = 'block';
                    document.getElementById('XYRow').style.display = 'flex';
                    document.getElementById('Heightwidthrow').style.display = 'flex';
                    document.getElementById('X1Y1Row').style.display = 'none';
                    document.getElementById('X2Y2Row').style.display = 'none';
                    document.getElementById('Line').style.display = 'none';
                    document.getElementById('InkAnnoatation').style.display = 'none';
                    document.getElementById('polygon').style.display = 'none';
                    document.getElementById('StampClicked').style.display = 'none';
                    document.getElementById('FreeText').style.display = 'none';
                    document.getElementById('FreeTextElement').style.display = 'none';
                    document.getElementById('e-pv-fileuploader').style.display = 'none';
                    document.getElementById('allowinstractionsIstrue').style.display = 'none';
                    break;
                }
            case 'Polygon':
            case 'Perimeter':
            case 'Area':
            case 'Volume':
                {
                    document.getElementById('polygon').style.display = 'block';
                    document.getElementById('XYRow').style.display = 'flex';
                    document.getElementById('Heightwidthrow').style.display = 'none';
                    document.getElementById('X1Y1Row').style.display = 'none';
                    document.getElementById('X2Y2Row').style.display = 'none';
                    document.getElementById('deladdboundsButtons').style.display = 'none';
                    document.getElementById('strokeThickness').style.display = 'flex';
                    document.getElementById('ColorFillerIstrue').style.display = 'block';
                    document.getElementById('InkAnnoatation').style.display = 'none';
                    document.getElementById('Line').style.display = 'none';
                    document.getElementById('StampClicked').style.display = 'none';
                    document.getElementById('FreeText').style.display = 'none';
                    document.getElementById('FreeTextElement').style.display = 'none';
                    document.getElementById('e-pv-fileuploader').style.display = 'none';
                    document.getElementById('allowinstractionsIstrue').style.display = 'none';
                    break;
                }
            case 'Distance':
                {
                    document.getElementById('strokeThickness').style.display = 'flex';
                    document.getElementById('deladdboundsButtons').style.display = 'none';
                    document.getElementById('ColorFillerIstrue').style.display = 'block';
                    document.getElementById('XYRow').style.display = 'none';
                    document.getElementById('Heightwidthrow').style.display = 'none';
                    document.getElementById('X1Y1Row').style.display = 'flex';
                    document.getElementById('X2Y2Row').style.display = 'flex';
                    document.getElementById('Line').style.display = 'block';
                    document.getElementById('distance').style.display = 'block';
                    document.getElementById('polygon').style.display = 'none';
                    document.getElementById('InkAnnoatation').style.display = 'none';
                    document.getElementById('StampClicked').style.display = 'none';
                    document.getElementById('FreeText').style.display = 'none';
                    document.getElementById('FreeTextElement').style.display = 'none';
                    document.getElementById('e-pv-fileuploader').style.display = 'none';
                    document.getElementById('allowinstractionsIstrue').style.display = 'none';
                    break;
                }
            case 'StickyNotes':
                {
                    document.getElementById('ColorFillerIstrue').style.display = 'none';
                    document.getElementById('strokeThickness').style.display = 'none';
                    document.getElementById('deladdboundsButtons').style.display = 'none';
                    document.getElementById('XYRow').style.display = 'flex';
                    document.getElementById('Heightwidthrow').style.display = 'flex';
                    document.getElementById('X1Y1Row').style.display = 'none';
                    document.getElementById('X2Y2Row').style.display = 'none';
                    document.getElementById('Line').style.display = 'none';
                    document.getElementById('distance').style.display = 'none';
                    document.getElementById('InkAnnoatation').style.display = 'none';
                    document.getElementById('polygon').style.display = 'none';
                    document.getElementById('StampClicked').style.display = 'none';
                    document.getElementById('FreeText').style.display = 'none';
                    document.getElementById('FreeTextElement').style.display = 'none';
                    document.getElementById('e-pv-fileuploader').style.display = 'none';
                    document.getElementById('allowinstractionsIstrue').style.display = 'none';
                    break;
                }
            case 'Ink':
                {
                    document.getElementById('strokeThickness').style.display = 'flex';
                    document.getElementById('deladdboundsButtons').style.display = 'none';
                    document.getElementById('ColorFillerIstrue').style.display = 'block';
                    document.getElementById('XYRow').style.display = 'flex';
                    document.getElementById('Heightwidthrow').style.display = 'flex';
                    document.getElementById('X1Y1Row').style.display = 'none';
                    document.getElementById('X2Y2Row').style.display = 'none';
                    document.getElementById('Line').style.display = 'none';
                    document.getElementById('polygon').style.display = 'none';
                    document.getElementById('InkAnnoatation').style.display = 'block';
                    document.getElementById('StampClicked').style.display = 'none';
                    document.getElementById('FreeText').style.display = 'none';
                    document.getElementById('FreeTextElement').style.display = 'none';
                    document.getElementById('e-pv-fileuploader').style.display = 'none';
                    document.getElementById('allowinstractionsIstrue').style.display = 'none';
                    break;
                }
            case 'Stamp':
                {
                    document.getElementById('ColorFillerIstrue').style.display = 'none';
                    document.getElementById('strokeThickness').style.display = 'none';
                    document.getElementById('deladdboundsButtons').style.display = 'none';
                    document.getElementById('XYRow').style.display = 'flex';
                    document.getElementById('Heightwidthrow').style.display = 'flex';
                    document.getElementById('X1Y1Row').style.display = 'none';
                    document.getElementById('X2Y2Row').style.display = 'none';
                    document.getElementById('Line').style.display = 'none';
                    document.getElementById('distance').style.display = 'none';
                    document.getElementById('InkAnnoatation').style.display = 'none';
                    document.getElementById('polygon').style.display = 'none';
                    document.getElementById('StampClicked').style.display = 'block';
                    if (selectedAnnotation.annotationSelected) {
                        document.getElementById('StampClicked').style.display = 'none';
                    }
                    document.getElementById('FreeText').style.display = 'none';
                    document.getElementById('FreeTextElement').style.display = 'none';
                    document.getElementById('e-pv-fileuploader').style.display = 'none';
                    document.getElementById('allowinstractionsIstrue').style.display = 'none';
                    findStampComments(document.getElementById('stampTypes').ej2_instances[0].value);
                    break;
                }
            case 'FreeText':
                {
                    document.getElementById('strokeThickness').style.display = 'flex';
                    document.getElementById('deladdboundsButtons').style.display = 'none';
                    document.getElementById('ColorFillerIstrue').style.display = 'block';
                    document.getElementById('XYRow').style.display = 'flex';
                    document.getElementById('Heightwidthrow').style.display = 'flex';
                    document.getElementById('X1Y1Row').style.display = 'none';
                    document.getElementById('X2Y2Row').style.display = 'none';
                    document.getElementById('Line').style.display = 'none';
                    document.getElementById('InkAnnoatation').style.display = 'none';
                    document.getElementById('polygon').style.display = 'none';
                    document.getElementById('StampClicked').style.display = 'none';
                    document.getElementById('FreeText').style.display = 'block';
                    document.getElementById('FreeTextElement').style.display = 'block';
                    document.getElementById('e-pv-fileuploader').style.display = 'none';
                    document.getElementById('allowinstractionsIstrue').style.display = 'none';
                    break;
                }
            case 'CustomStamp':
                {
                    document.getElementById('ColorFillerIstrue').style.display = 'none';
                    document.getElementById('strokeThickness').style.display = 'none';
                    document.getElementById('deladdboundsButtons').style.display = 'none';
                    document.getElementById('XYRow').style.display = 'flex';
                    document.getElementById('Heightwidthrow').style.display = 'flex';
                    document.getElementById('X1Y1Row').style.display = 'none';
                    document.getElementById('X2Y2Row').style.display = 'none';
                    document.getElementById('Line').style.display = 'none';
                    document.getElementById('distance').style.display = 'none';
                    document.getElementById('InkAnnoatation').style.display = 'none';
                    document.getElementById('polygon').style.display = 'none';
                    document.getElementById('StampClicked').style.display = 'none';
                    document.getElementById('FreeText').style.display = 'none';
                    document.getElementById('FreeTextElement').style.display = 'none';
                    document.getElementById('e-pv-fileuploader').style.display = 'block';
                    if (selectedAnnotation.annotationSelected) {
                        document.getElementById('e-pv-fileuploader').style.display = 'none';
                    }
                    document.getElementById('allowinstractionsIstrue').style.display = 'none';
                    break;
                }
        }
        if (selectedAnnotation.annotationUnSelected && isElementLoaded) {
            resetAnnotationProperties();
            document.getElementById('checkedReplybox').style.display = "none";
        }
        if (selectedAnnotation.isLocked && isElementLoaded) {
            document.getElementById('checkedReplybox').style.display = "block";
        }
    }
    function findStampComments(type) {
        if (type === 'Dynamic') {
            document.getElementById('dynamicStampListElement').style.display = 'block';
            document.getElementById('signHereStampListElement').style.display = "none";
            document.getElementById('standardBusinessStampListElement').style.display = "none";
        }
        else if (type === 'Sign Here' || type === 'SignHere') {
            document.getElementById('dynamicStampListElement').style.display = 'none';
            document.getElementById('signHereStampListElement').style.display = "block";
            document.getElementById('standardBusinessStampListElement').style.display = "none";
        }
        else if (type === 'Standard Business' || type === 'StandardBusiness') {
            document.getElementById('dynamicStampListElement').style.display = 'none';
            document.getElementById('signHereStampListElement').style.display = "none";
            document.getElementById('standardBusinessStampListElement').style.display = "block";
        }
        else {
            document.getElementById('dynamicStampListElement').style.display = 'none';
            document.getElementById('signHereStampListElement').style.display = "none";
            document.getElementById('standardBusinessStampListElement').style.display = "none";
        }

    }
    function change(args) {
        var viewer = document.getElementById('pdfviewer').ej2_instances[0];
        if (args.checked) {
            viewer.serviceUrl = '';
        } else {
            viewer.serviceUrl = '@serviceUrl';
        }
        viewer.dataBind();
        viewer.load(viewer.documentPath, null);
    }
    //Method to change allowed interactions container visibility
   function onLockCheckedChange(args) {
        selectedAnnotation.isLocked = args.checked;
       if (args.checked) {
           if (selectedAnnotation.annotationSelected) {
               allowedInteractionsElement.value = selectedAnnotation.allowedInteractions;
           }
           else {
               selectedAnnotation.allowedInteractions = ["Select", "Resize"];
               allowedInteractionsElement.value = selectedAnnotation.allowedInteractions;
           }
            document.getElementById('allowinstractionsIstrue').style.display = 'block';
            allowedInteractionsElement.refresh();
        }
       else {
            document.getElementById('allowinstractionsIstrue').style.display = 'none';
        }
        if (selectedAnnotation.annotationSelected) {
            document.getElementById('updateAnnotation').disabled = false;
        }
    }
    //Method to set replies container visibity 
    function onReplyCheckedChange(args) {
        selectedAnnotation.isReply = args.checked;
        if (args.checked) {
            document.getElementById('checkedReplybox').style.display = "block";
        }
        else {
            document.getElementById('checkedReplybox').style.display = "none";
        }
    }
    //Method to update the properties panel on annotation move and resize
    function UpdateAnnotationPropertiesToPanel(args) {
        selectedAnnotationId = args.annotationId;
        var viewer = document.getElementById('pdfviewer').ej2_instances[0]
        var index = -1;
        for (var i = 0; i < viewer.annotationCollection.length; i++) {
            if (viewer.annotationCollection[i].annotationId === selectedAnnotationId) {
                index = i;
                break;
            }
        }

        // Ensure index is found, then update the properties to the panel
        if (index !== -1) {
            updatePropertiesToPanel(viewer.annotationCollection[index]);
        }
    }
    //Method to add new annotation by Add Annotation method
    function addNewAnnotation() {
        var viewer = document.getElementById('pdfviewer').ej2_instances[0];
        var currentAnnotationSettings = annotationSettings();
        switch (selectedAnnotation.annotationType) {
            case "Highlight":
            case "Underline":
            case "Strikethrough":
            case "Squiggly":
                {
                    viewer.annotation.addAnnotation(selectedAnnotation.annotationType, currentAnnotationSettings);
                    break;
                }
            case "Rectangle":
            case "Circle":
            case "StickyNotes":
            case "FreeText":
                {
                    viewer.annotation.addAnnotation(selectedAnnotation.annotationType, currentAnnotationSettings);
                    break;
                }
            case "Line":
            case "Arrow":
                {
                    if (selectedAnnotation.vertexPoints.length === 0) {
                        selectedAnnotation.vertexPoints.push({ x: selectedAnnotation.vertexX1, y: selectedAnnotation.vertexY1 },
                            { x: selectedAnnotation.vertexX2, y: selectedAnnotation.vertexY2 });
                    }
                    viewer.annotation.addAnnotation(selectedAnnotation.annotationType, currentAnnotationSettings);
                    selectedAnnotation.vertexPoints = [];
                    break;
                }
            case "Polygon":
            case "Perimeter":
            case "Area":
            case "Volume":
                {
                    if (selectedAnnotation.vertexPoints.length === 0) {
                        if (selectedAnnotation.annotationType === "Polygon") {
                            selectedAnnotation.vertexPoints.push({ x: 100, y: 39 }, { x: 142, y: 10 }, { x: 189, y: 38 }, { x: 178, y: 81 }, { x: 111, y: 81 }, { x: 100, y: 39 });
                        }
                        else if (selectedAnnotation.annotationType === "Perimeter") {
                            selectedAnnotation.vertexPoints.push({ x: 100, y: 100 }, { x: 185, y: 100 }, { x: 186, y: 162 });
                        }
                        else if (selectedAnnotation.annotationType === "Area") {
                            selectedAnnotation.vertexPoints.push({ x: 100, y: 100 }, { x: 188, y: 99 }, { x: 189, y: 153 }, { x: 100, y: 100 });
                        }
                        else if (selectedAnnotation.annotationType === "Volume") {
                            selectedAnnotation.vertexPoints.push({ x: 100, y: 100 }, { x: 100, y: 209 }, { x: 220, y: 209 }, { x: 220, y: 99 }, { x: 100, y: 100 });
                        }
                    }
                    viewer.annotation.addAnnotation(selectedAnnotation.annotationType, currentAnnotationSettings);
                    break;
                }
            case "Radius":
                {
                    if (selectedAnnotation.vertexPoints.length === 0) {
                        selectedAnnotation.vertexPoints.push({ x: 200, y: 500 }, { x: 250, y: 550 });
                    }
                    viewer.annotation.addAnnotation(selectedAnnotation.annotationType, currentAnnotationSettings);
                    break;
                }
            case "Distance":
                {
                    if (selectedAnnotation.vertexPoints.length === 0) {
                        selectedAnnotation.vertexPoints.push({ x: selectedAnnotation.vertexX1, y: selectedAnnotation.vertexY1 },
                            { x: selectedAnnotation.vertexX2, y: selectedAnnotation.vertexY2 });
                    }
                    currentAnnotationSettings.vertexPoints = selectedAnnotation.vertexPoints;
                    viewer.annotation.addAnnotation(selectedAnnotation.annotationType, currentAnnotationSettings);
                    break;
                }
            case "Ink":
                {
                    if (selectedAnnotation.inkAnnotationType === "Syncfusion") {
                        selectedAnnotation.path = '[{\"command\":\"M\",\"x\":244.83334350585938,\"y\":982.0000305175781},{\"command\":\"L\",\"x\":244.83334350585938,\"y\":982.0000305175781},{\"command\":\"L\",\"x\":250.83334350585938,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":252.83334350585938,\"y\":946.0000305175781},{\"command\":\"L\",\"x\":254.16668701171875,\"y\":940.6667175292969},{\"command\":\"L\",\"x\":256.8333435058594,\"y\":931.3333435058594},{\"command\":\"L\",\"x\":257.5,\"y\":929.3333435058594},{\"command\":\"L\",\"x\":258.8333435058594,\"y\":926.6667175292969},{\"command\":\"L\",\"x\":259.5,\"y\":924.0000305175781},{\"command\":\"L\",\"x\":259.5,\"y\":922.6667175292969},{\"command\":\"L\",\"x\":258.8333435058594,\"y\":922.0000305175781},{\"command\":\"L\",\"x\":258.16668701171875,\"y\":922.0000305175781},{\"command\":\"L\",\"x\":256.8333435058594,\"y\":922.0000305175781},{\"command\":\"L\",\"x\":256.16668701171875,\"y\":922.6667175292969},{\"command\":\"L\",\"x\":254.83334350585938,\"y\":923.3333435058594},{\"command\":\"L\",\"x\":254.16668701171875,\"y\":923.3333435058594},{\"command\":\"L\",\"x\":253.5,\"y\":923.3333435058594},{\"command\":\"L\",\"x\":252.83334350585938,\"y\":925.3333435058594},{\"command\":\"L\",\"x\":252.83334350585938,\"y\":927.3333435058594},{\"command\":\"L\",\"x\":252.83334350585938,\"y\":936.0000305175781},{\"command\":\"L\",\"x\":253.5,\"y\":940.6667175292969},{\"command\":\"L\",\"x\":254.83334350585938,\"y\":944.6667175292969},{\"command\":\"L\",\"x\":260.16668701171875,\"y\":952.0000305175781},{\"command\":\"L\",\"x\":264.16668701171875,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":274.16668701171875,\"y\":958.6667175292969},{\"command\":\"L\",\"x\":278.16668701171875,\"y\":960.0000305175781},{\"command\":\"L\",\"x\":281.5,\"y\":961.3333435058594},{\"command\":\"L\",\"x\":285.5,\"y\":964.6667175292969},{\"command\":\"L\",\"x\":286.8333740234375,\"y\":967.3333435058594},{\"command\":\"L\",\"x\":286.8333740234375,\"y\":970.0000305175781},{\"command\":\"L\",\"x\":282.8333740234375,\"y\":978.6667175292969},{\"command\":\"L\",\"x\":278.16668701171875,\"y\":983.3333435058594},{\"command\":\"L\",\"x\":266.16668701171875,\"y\":991.3333435058594},{\"command\":\"L\",\"x\":259.5,\"y\":993.3333435058594},{\"command\":\"L\",\"x\":252.16668701171875,\"y\":994.0000305175781},{\"command\":\"L\",\"x\":240.83334350585938,\"y\":991.3333435058594},{\"command\":\"L\",\"x\":236.16668701171875,\"y\":988.6667175292969},{\"command\":\"L\",\"x\":230.16668701171875,\"y\":982.6667175292969},{\"command\":\"L\",\"x\":228.83334350585938,\"y\":980.6667175292969},{\"command\":\"L\",\"x\":228.16668701171875,\"y\":978.6667175292969},{\"command\":\"L\",\"x\":228.83334350585938,\"y\":974.6667175292969},{\"command\":\"L\",\"x\":230.16668701171875,\"y\":973.3333435058594},{\"command\":\"L\",\"x\":236.16668701171875,\"y\":971.3333435058594},{\"command\":\"L\",\"x\":240.83334350585938,\"y\":971.3333435058594},{\"command\":\"L\",\"x\":246.16668701171875,\"y\":972.0000305175781},{\"command\":\"L\",\"x\":257.5,\"y\":974.6667175292969},{\"command\":\"L\",\"x\":262.8333435058594,\"y\":976.0000305175781},{\"command\":\"L\",\"x\":269.5,\"y\":977.3333435058594},{\"command\":\"L\",\"x\":276.16668701171875,\"y\":978.6667175292969},{\"command\":\"L\",\"x\":279.5,\"y\":978.0000305175781},{\"command\":\"L\",\"x\":285.5,\"y\":976.6667175292969},{\"command\":\"L\",\"x\":288.16668701171875,\"y\":974.6667175292969},{\"command\":\"L\",\"x\":292.8333740234375,\"y\":969.3333435058594},{\"command\":\"L\",\"x\":293.5,\"y\":966.6667175292969},{\"command\":\"L\",\"x\":294.16668701171875,\"y\":964.0000305175781},{\"command\":\"L\",\"x\":293.5,\"y\":960.0000305175781},{\"command\":\"L\",\"x\":293.5,\"y\":958.0000305175781},{\"command\":\"L\",\"x\":292.8333740234375,\"y\":956.6667175292969},{\"command\":\"L\",\"x\":291.5,\"y\":954.6667175292969},{\"command\":\"L\",\"x\":291.5,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":291.5,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":291.5,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":292.16668701171875,\"y\":954.6667175292969},{\"command\":\"L\",\"x\":292.8333740234375,\"y\":956.0000305175781},{\"command\":\"L\",\"x\":294.16668701171875,\"y\":961.3333435058594},{\"command\":\"L\",\"x\":295.5,\"y\":964.6667175292969},{\"command\":\"L\",\"x\":297.5,\"y\":969.3333435058594},{\"command\":\"L\",\"x\":298.8333740234375,\"y\":970.6667175292969},{\"command\":\"L\",\"x\":301.5,\"y\":970.0000305175781},{\"command\":\"L\",\"x\":304.16668701171875,\"y\":968.6667175292969},{\"command\":\"L\",\"x\":305.5,\"y\":966.0000305175781},{\"command\":\"L\",\"x\":308.8333740234375,\"y\":960.0000305175781},{\"command\":\"L\",\"x\":310.16668701171875,\"y\":957.3333435058594},{\"command\":\"L\",\"x\":310.8333740234375,\"y\":956.0000305175781},{\"command\":\"L\",\"x\":310.8333740234375,\"y\":954.6667175292969},{\"command\":\"L\",\"x\":310.8333740234375,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":311.5,\"y\":956.0000305175781},{\"command\":\"L\",\"x\":312.8333740234375,\"y\":959.3333435058594},{\"command\":\"L\",\"x\":316.16668701171875,\"y\":968.0000305175781},{\"command\":\"L\",\"x\":317.5,\"y\":972.6667175292969},{\"command\":\"L\",\"x\":318.16668701171875,\"y\":977.3333435058594},{\"command\":\"L\",\"x\":319.5,\"y\":983.3333435058594},{\"command\":\"L\",\"x\":319.5,\"y\":986.0000305175781},{\"command\":\"L\",\"x\":319.5,\"y\":988.0000305175781},{\"command\":\"L\",\"x\":318.8333740234375,\"y\":988.0000305175781},{\"command\":\"L\",\"x\":318.16668701171875,\"y\":988.6667175292969},{\"command\":\"L\",\"x\":316.16668701171875,\"y\":987.3333435058594},{\"command\":\"L\",\"x\":314.8333740234375,\"y\":985.3333435058594},{\"command\":\"L\",\"x\":314.16668701171875,\"y\":980.6667175292969},{\"command\":\"L\",\"x\":314.8333740234375,\"y\":974.6667175292969},{\"command\":\"L\",\"x\":316.16668701171875,\"y\":969.3333435058594},{\"command\":\"L\",\"x\":319.5,\"y\":960.6667175292969},{\"command\":\"L\",\"x\":320.16668701171875,\"y\":957.3333435058594},{\"command\":\"L\",\"x\":321.5,\"y\":955.3333435058594},{\"command\":\"L\",\"x\":322.16668701171875,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":322.8333740234375,\"y\":952.6667175292969},{\"command\":\"L\",\"x\":324.16668701171875,\"y\":952.6667175292969},{\"command\":\"L\",\"x\":324.8333740234375,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":326.8333740234375,\"y\":956.0000305175781},{\"command\":\"L\",\"x\":328.16668701171875,\"y\":958.0000305175781},{\"command\":\"L\",\"x\":328.8333740234375,\"y\":960.0000305175781},{\"command\":\"L\",\"x\":329.5,\"y\":962.0000305175781},{\"command\":\"L\",\"x\":330.16668701171875,\"y\":962.0000305175781},{\"command\":\"L\",\"x\":330.16668701171875,\"y\":962.6667175292969},{\"command\":\"L\",\"x\":330.16668701171875,\"y\":962.0000305175781},{\"command\":\"L\",\"x\":330.8333740234375,\"y\":960.0000305175781},{\"command\":\"L\",\"x\":331.5,\"y\":956.0000305175781},{\"command\":\"L\",\"x\":332.8333740234375,\"y\":952.0000305175781},{\"command\":\"L\",\"x\":333.5,\"y\":950.0000305175781},{\"command\":\"L\",\"x\":334.8333740234375,\"y\":948.6667175292969},{\"command\":\"L\",\"x\":335.5,\"y\":948.6667175292969},{\"command\":\"L\",\"x\":336.16668701171875,\"y\":948.6667175292969},{\"command\":\"L\",\"x\":337.5,\"y\":950.6667175292969},{\"command\":\"L\",\"x\":338.8333740234375,\"y\":952.0000305175781},{\"command\":\"L\",\"x\":340.8333740234375,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":341.5,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":342.8333740234375,\"y\":954.6667175292969},{\"command\":\"L\",\"x\":344.8333740234375,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":346.8333740234375,\"y\":952.6667175292969},{\"command\":\"L\",\"x\":349.5,\"y\":949.3333435058594},{\"command\":\"L\",\"x\":350.8333740234375,\"y\":948.0000305175781},{\"command\":\"L\",\"x\":351.5,\"y\":946.6667175292969},{\"command\":\"L\",\"x\":352.8333740234375,\"y\":944.0000305175781},{\"command\":\"L\",\"x\":352.8333740234375,\"y\":943.3333435058594},{\"command\":\"L\",\"x\":354.16668701171875,\"y\":942.0000305175781},{\"command\":\"L\",\"x\":354.8333740234375,\"y\":942.0000305175781},{\"command\":\"L\",\"x\":354.8333740234375,\"y\":942.6667175292969},{\"command\":\"L\",\"x\":354.16668701171875,\"y\":943.3333435058594},{\"command\":\"L\",\"x\":354.16668701171875,\"y\":946.6667175292969},{\"command\":\"L\",\"x\":354.16668701171875,\"y\":950.0000305175781},{\"command\":\"L\",\"x\":355.5,\"y\":956.0000305175781},{\"command\":\"L\",\"x\":356.16668701171875,\"y\":957.3333435058594},{\"command\":\"L\",\"x\":358.16668701171875,\"y\":959.3333435058594},{\"command\":\"L\",\"x\":360.16668701171875,\"y\":958.0000305175781},{\"command\":\"L\",\"x\":364.16668701171875,\"y\":956.0000305175781},{\"command\":\"L\",\"x\":370.8333740234375,\"y\":948.6667175292969},{\"command\":\"L\",\"x\":373.5,\"y\":943.3333435058594},{\"command\":\"L\",\"x\":375.5,\"y\":937.3333435058594},{\"command\":\"L\",\"x\":376.16668701171875,\"y\":933.3333435058594},{\"command\":\"L\",\"x\":376.8333740234375,\"y\":931.3333435058594},{\"command\":\"L\",\"x\":376.8333740234375,\"y\":930.0000305175781},{\"command\":\"L\",\"x\":376.8333740234375,\"y\":929.3333435058594},{\"command\":\"L\",\"x\":376.16668701171875,\"y\":930.0000305175781},{\"command\":\"L\",\"x\":375.5,\"y\":932.0000305175781},{\"command\":\"L\",\"x\":375.5,\"y\":937.3333435058594},{\"command\":\"L\",\"x\":374.8333740234375,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":374.8333740234375,\"y\":960.6667175292969},{\"command\":\"L\",\"x\":375.5,\"y\":966.0000305175781},{\"command\":\"L\",\"x\":377.5,\"y\":974.6667175292969},{\"command\":\"L\",\"x\":378.16668701171875,\"y\":977.3333435058594},{\"command\":\"L\",\"x\":380.8333740234375,\"y\":981.3333435058594},{\"command\":\"L\",\"x\":382.16668701171875,\"y\":982.6667175292969},{\"command\":\"L\",\"x\":383.5,\"y\":982.6667175292969},{\"command\":\"L\",\"x\":387.5,\"y\":982.6667175292969},{\"command\":\"L\",\"x\":389.5,\"y\":980.6667175292969},{\"command\":\"L\",\"x\":392.16668701171875,\"y\":976.6667175292969},{\"command\":\"L\",\"x\":392.8333740234375,\"y\":973.3333435058594},{\"command\":\"L\",\"x\":392.16668701171875,\"y\":970.0000305175781},{\"command\":\"L\",\"x\":388.8333740234375,\"y\":965.3333435058594},{\"command\":\"L\",\"x\":385.5,\"y\":964.0000305175781},{\"command\":\"L\",\"x\":382.8333740234375,\"y\":964.0000305175781},{\"command\":\"L\",\"x\":377.5,\"y\":964.0000305175781},{\"command\":\"L\",\"x\":375.5,\"y\":964.6667175292969},{\"command\":\"L\",\"x\":373.5,\"y\":965.3333435058594},{\"command\":\"L\",\"x\":374.8333740234375,\"y\":963.3333435058594},{\"command\":\"L\",\"x\":376.8333740234375,\"y\":961.3333435058594},{\"command\":\"L\",\"x\":382.16668701171875,\"y\":956.0000305175781},{\"command\":\"L\",\"x\":384.16668701171875,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":387.5,\"y\":950.6667175292969},{\"command\":\"L\",\"x\":388.16668701171875,\"y\":952.0000305175781},{\"command\":\"L\",\"x\":388.16668701171875,\"y\":952.6667175292969},{\"command\":\"L\",\"x\":388.8333740234375,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":388.8333740234375,\"y\":954.6667175292969},{\"command\":\"L\",\"x\":389.5,\"y\":959.3333435058594},{\"command\":\"L\",\"x\":389.5,\"y\":960.6667175292969},{\"command\":\"L\",\"x\":390.16668701171875,\"y\":961.3333435058594},{\"command\":\"L\",\"x\":390.8333740234375,\"y\":960.6667175292969},{\"command\":\"L\",\"x\":393.5,\"y\":958.0000305175781},{\"command\":\"L\",\"x\":396.8333740234375,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":398.16668701171875,\"y\":952.0000305175781},{\"command\":\"L\",\"x\":400.16668701171875,\"y\":949.3333435058594},{\"command\":\"L\",\"x\":400.16668701171875,\"y\":948.6667175292969},{\"command\":\"L\",\"x\":400.8333740234375,\"y\":948.0000305175781},{\"command\":\"L\",\"x\":400.8333740234375,\"y\":947.3333435058594},{\"command\":\"L\",\"x\":401.5,\"y\":948.0000305175781},{\"command\":\"L\",\"x\":402.16668701171875,\"y\":949.3333435058594},{\"command\":\"L\",\"x\":403.5,\"y\":950.6667175292969},{\"command\":\"L\",\"x\":404.8333740234375,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":406.16668701171875,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":407.5,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":410.16668701171875,\"y\":952.0000305175781},{\"command\":\"L\",\"x\":412.16668701171875,\"y\":949.3333435058594},{\"command\":\"L\",\"x\":414.16668701171875,\"y\":944.6667175292969},{\"command\":\"L\",\"x\":414.16668701171875,\"y\":942.0000305175781},{\"command\":\"L\",\"x\":414.16668701171875,\"y\":940.6667175292969},{\"command\":\"L\",\"x\":414.16668701171875,\"y\":938.6667175292969},{\"command\":\"L\",\"x\":414.16668701171875,\"y\":938.0000305175781},{\"command\":\"L\",\"x\":415.5,\"y\":939.3333435058594},{\"command\":\"L\",\"x\":418.8333740234375,\"y\":942.6667175292969},{\"command\":\"L\",\"x\":420.16668701171875,\"y\":945.3333435058594},{\"command\":\"L\",\"x\":421.5,\"y\":946.6667175292969},{\"command\":\"L\",\"x\":422.8333740234375,\"y\":950.0000305175781},{\"command\":\"L\",\"x\":423.5,\"y\":950.6667175292969},{\"command\":\"L\",\"x\":423.5,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":422.8333740234375,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":421.5,\"y\":955.3333435058594},{\"command\":\"L\",\"x\":421.5,\"y\":956.0000305175781},{\"command\":\"L\",\"x\":422.16668701171875,\"y\":954.6667175292969},{\"command\":\"L\",\"x\":422.8333740234375,\"y\":954.0000305175781},{\"command\":\"L\",\"x\":424.8333740234375,\"y\":950.6667175292969},{\"command\":\"L\",\"x\":425.5,\"y\":948.6667175292969},{\"command\":\"L\",\"x\":428.16668701171875,\"y\":945.3333435058594},{\"command\":\"L\",\"x\":428.8333740234375,\"y\":943.3333435058594},{\"command\":\"L\",\"x\":428.8333740234375,\"y\":942.6667175292969},{\"command\":\"L\",\"x\":428.8333740234375,\"y\":943.3333435058594},{\"command\":\"L\",\"x\":428.8333740234375,\"y\":945.3333435058594},{\"command\":\"L\",\"x\":428.8333740234375,\"y\":948.0000305175781},{\"command\":\"L\",\"x\":428.8333740234375,\"y\":950.0000305175781},{\"command\":\"L\",\"x\":429.5,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":430.16668701171875,\"y\":953.3333435058594},{\"command\":\"L\",\"x\":432.8333740234375,\"y\":952.6667175292969},{\"command\":\"L\",\"x\":434.8333740234375,\"y\":950.6667175292969},{\"command\":\"L\",\"x\":437.5,\"y\":948.6667175292969},{\"command\":\"L\",\"x\":440.16668701171875,\"y\":944.6667175292969},{\"command\":\"L\",\"x\":441.5,\"y\":942.6667175292969},{\"command\":\"L\",\"x\":442.16668701171875,\"y\":942.0000305175781},{\"command\":\"L\",\"x\":442.8333740234375,\"y\":941.3333435058594},{\"command\":\"L\",\"x\":442.8333740234375,\"y\":942.0000305175781},{\"command\":\"L\",\"x\":442.8333740234375,\"y\":943.3333435058594},{\"command\":\"L\",\"x\":442.8333740234375,\"y\":944.6667175292969},{\"command\":\"L\",\"x\":442.8333740234375,\"y\":946.0000305175781},{\"command\":\"L\",\"x\":443.5,\"y\":949.3333435058594},{\"command\":\"L\",\"x\":444.16668701171875,\"y\":950.6667175292969},{\"command\":\"L\",\"x\":445.5,\"y\":950.6667175292969},{\"command\":\"L\",\"x\":447.5,\"y\":950.6667175292969},{\"command\":\"L\",\"x\":450.16668701171875,\"y\":948.6667175292969},{\"command\":\"L\",\"x\":452.16668701171875,\"y\":945.3333435058594},{\"command\":\"L\",\"x\":453.5,\"y\":942.6667175292969},{\"command\":\"L\",\"x\":452.8333740234375,\"y\":938.6667175292969},{\"command\":\"L\",\"x\":452.16668701171875,\"y\":937.3333435058594},{\"command\":\"L\",\"x\":450.8333740234375,\"y\":936.6667175292969},{\"command\":\"L\",\"x\":448.8333740234375,\"y\":936.0000305175781},{\"command\":\"L\",\"x\":447.5,\"y\":936.6667175292969},{\"command\":\"L\",\"x\":446.16668701171875,\"y\":937.3333435058594},{\"command\":\"L\",\"x\":445.5,\"y\":938.6667175292969},{\"command\":\"L\",\"x\":445.5,\"y\":939.3333435058594},{\"command\":\"L\",\"x\":446.16668701171875,\"y\":939.3333435058594},{\"command\":\"L\",\"x\":446.8333740234375,\"y\":939.3333435058594},{\"command\":\"L\",\"x\":452.16668701171875,\"y\":937.3333435058594},{\"command\":\"L\",\"x\":454.8333740234375,\"y\":936.6667175292969},{\"command\":\"L\",\"x\":456.8333740234375,\"y\":936.0000305175781},{\"command\":\"L\",\"x\":459.5,\"y\":936.6667175292969},{\"command\":\"L\",\"x\":460.8333740234375,\"y\":937.3333435058594},{\"command\":\"L\",\"x\":461.5,\"y\":938.6667175292969},{\"command\":\"L\",\"x\":462.16668701171875,\"y\":942.0000305175781},{\"command\":\"L\",\"x\":462.16668701171875,\"y\":942.6667175292969},{\"command\":\"L\",\"x\":462.16668701171875,\"y\":944.0000305175781},{\"command\":\"L\",\"x\":462.16668701171875,\"y\":943.3333435058594},{\"command\":\"L\",\"x\":462.16668701171875,\"y\":942.6667175292969},{\"command\":\"L\",\"x\":462.16668701171875,\"y\":941.3333435058594},{\"command\":\"L\",\"x\":462.8333740234375,\"y\":938.6667175292969},{\"command\":\"L\",\"x\":464.16668701171875,\"y\":935.3333435058594},{\"command\":\"L\",\"x\":465.5,\"y\":933.3333435058594},{\"command\":\"L\",\"x\":466.16668701171875,\"y\":932.6667175292969},{\"command\":\"L\",\"x\":467.5,\"y\":933.3333435058594},{\"command\":\"L\",\"x\":469.5,\"y\":935.3333435058594},{\"command\":\"L\",\"x\":470.16668701171875,\"y\":938.6667175292969},{\"command\":\"L\",\"x\":472.8333740234375,\"y\":943.3333435058594},{\"command\":\"L\",\"x\":472.8333740234375,\"y\":944.6667175292969},{\"command\":\"L\",\"x\":474.16668701171875,\"y\":944.6667175292969},{\"command\":\"L\",\"x\":475.5,\"y\":944.0000305175781},{\"command\":\"L\",\"x\":478.16668701171875,\"y\":941.3333435058594},{\"command\":\"L\",\"x\":481.5,\"y\":937.3333435058594},{\"command\":\"L\",\"x\":484.8333740234375,\"y\":934.0000305175781},{\"command\":\"L\",\"x\":488.8333740234375,\"y\":929.3333435058594},{\"command\":\"L\",\"x\":489.5,\"y\":928.0000305175781}]';
                    }
                    else if (selectedAnnotation.inkAnnotationType === "PdfViewer") {
                        selectedAnnotation.path = "M10,50 L10,65 M10,50 L25,50 L25,57.5 L10,57.5 M40, 50 L40, 65 M40, 50 L43, 50 L55, 55 L55, 60 L43, 65 L40, 65 M80, 50 L80, 65 M80, 50 L95, 50 M80, 57.5 L95, 57.5 M110, 50 L125, 65 L140, 50 M160, 50 L160, 65 M155, 50 L165, 50 M155, 65 L165, 65 M182, 50 L192, 65 L202, 50 L212, 65 L222, 50 M230, 50 L230, 65 M230, 50 L240, 50 M230, 57.5 L240, 57.5 M230, 65 L240, 65 M255, 50 L270, 65 L285, 50 M295, 50 L295, 65 M290, 50 L300, 50 M290, 65 L300, 65 M310, 50 L310, 65 M310, 50 L325, 50 M310, 57.5 L325, 57.5 M310, 65 L325, 65 M340, 50 L340, 65 M340, 50 L355, 50 L355, 57.5 L340, 57.5 M340, 57.5 L355, 65";
                    }
                    else if (selectedAnnotation.inkAnnotationType === "Star") {
                        selectedAnnotation.path ='[{\"command\":\"M\",\"x\":72,\"y\":200},{\"command\":\"L\",\"x\":79,\"y\":65},{\"command\":\"L\",\"x\":92,\"y\":200},{\"command\":\"L\",\"x\":65,\"y\":110},{\"command\":\"L\",\"x\":95,\"y\":110},{\"command\":\"L\",\"x\":72,\"y\":200}]';
                    }
                    currentAnnotationSettings.path = selectedAnnotation.path;
                    currentAnnotationSettings.isCommentLock = selectedAnnotation.isLocked;
                    viewer.annotation.addAnnotation(selectedAnnotation.annotationType, currentAnnotationSettings);
                    break;
                }

            case "Stamp":
            case "stamp":
                {
                    currentAnnotationSettings.customStamps = null;
                    var selectedStampItem;
                    if (stampTypeElement.value === "Dynamic") {
                        viewer.annotation.addAnnotation("Stamp", currentAnnotationSettings, dynamicStampElement.itemData.ID);
                    } else if (stampTypeElement.value === "SignHere") {
                        viewer.annotation.addAnnotation("Stamp", currentAnnotationSettings, null, signHereStampElement.itemData.ID);
                    } else {
                        viewer.annotation.addAnnotation("Stamp", currentAnnotationSettings, null, null, standardBusinessStampElement.itemData.ID);
                    }
                    break;
                }
            case "CustomStamp":
                {   
                    viewer.annotation.addAnnotation("Stamp", currentAnnotationSettings);
                    uploadElement.clearAll();
                    break;
                }
        }
        var newAnnotation = viewer.annotationCollection[viewer.annotationCollection.length - 1];
        if (newAnnotation) {
            updateAnnotationComments(newAnnotation);
            viewer.annotation.editAnnotation(newAnnotation);
        }
        resetReplies();
    }
    //Function for updating the annotation properties on annotation settings
    var annotationSettings = function () {
        return ({
            offset: { x: selectedAnnotation.x, y: selectedAnnotation.y },
            pageNumber: selectedAnnotation.pageNumber,
            width: selectedAnnotation.width,
            height: selectedAnnotation.height,
            opacity: parseInt((selectedAnnotation.opacity) / 100, 10),
            thickness: selectedAnnotation.thickness,
            strokeColor: selectedAnnotation.strokeColor,
            fillColor: selectedAnnotation.fillColor,
            bounds: (selectedAnnotation.bounds && selectedAnnotation.bounds.length > 0) ? selectedAnnotation.bounds.map((item) => ({ x: item.X, y: item.Y, width: item.Width, height: item.Height })) :
                [{
                    x: selectedAnnotation.x,
                    y: selectedAnnotation.y,
                    width: selectedAnnotation.width,
                    height: selectedAnnotation.height
                }],
            vertexPoints: selectedAnnotation.vertexPoints,
            fontFamily: selectedAnnotation.fontFamily,
            fontStyle: selectedAnnotation.fontStyle,
            fontSize: selectedAnnotation.fontSize,
            defaultText: selectedAnnotation.defaultText,
            textAlignment: selectedAnnotation.alignment,
            author: selectedAnnotation.author,
            setState: selectedAnnotation.state,
            note: selectedAnnotation.comment,
            comments: selectedAnnotation.replyComments,
            replyAuthor: selectedAnnotation.replyAuthor,
            replyState: selectedAnnotation.replyState,
            replyComment: selectedAnnotation.replyComment,
            modifiedDate: selectedAnnotation.modifiedDate,
            replyModifiedDate: selectedAnnotation.replyModifiedDate,
            lineHeadStartStyle: viewer.annotation.getArrowString(selectedAnnotation.lineHeadStartStyle),
            lineHeadEndStyle: viewer.annotation.getArrowString(selectedAnnotation.lineHeadEndStyle),
            leaderLength: selectedAnnotation.leaderLength,
            inkAnnotationType: selectedAnnotation.inkAnnotationType,
            color: selectedAnnotation.fillColor,
            allowedInteractions: selectedAnnotation.allowedInteractions,
            dynamicStamps: selectedAnnotation.dynamicStamp,
            signStamps: selectedAnnotation.signHereStamp,
            standardBusinessStamps: selectedAnnotation.standardBusinessStamp,
            path: selectedAnnotation.path,
            fontColor: selectedAnnotation.fontColor,
            isPrint: selectedAnnotation.isPrint,
            isLock: selectedAnnotation.isLocked,
            borderColor: selectedAnnotation.strokeColor,
            customStamps: [{
                customStampImageSource: selectedAnnotation.customStampImageSource,
                customStampName: selectedAnnotation.customStampName,
            }]
        });
    };
    //Method to update image path for custom stamp annotation
    function onFileSuccess(args) {
        var fileData = args.file.rawFile;
        if (fileData instanceof Blob) {
            convertBlobToBase64(fileData).then(function (base64String) {
                selectedAnnotation.customStampName = "Image";
                if(args.operation === "remove"){
                    selectedAnnotation.customStampImageSource = "@syncfusionLogo";
                }
                else{
                    selectedAnnotation.customStampImageSource = base64String;
                    document.getElementById('uploadedImage').src = base64String;
                    document.getElementById('fileName').innerHTML = args.file.name;
                } 
            })
                .catch(function (error) {
                    console.error("Failed to convert Blob to base64:", error);
                });
        }
        else {
            console.error("Unexpected file data type:", typeof fileData);
        }
    }
    //Method to convert Blob data to base64 string
    function convertBlobToBase64(blob) {
        return new Promise(function (resolve, reject) {
            var reader = new FileReader();
            reader.onloadend = function () {
                resolve(reader.result);
            };
            reader.onerror = reject;
            reader.readAsDataURL(blob);
        });
    }
    //Method to add new reply comment for an annotation
    function updateReply() {
        var currentReplyComment = new Comment();
        currentReplyComment.id = generateRandomId();
        currentReplyComment.author = selectedAnnotation.replyAuthor;
        currentReplyComment.note = selectedAnnotation.replyComment;
        currentReplyComment.modifiedDate = formatCurrentDate(new Date());
        currentReplyComment.state = selectedAnnotation.replyState;

        selectedAnnotation.replyComments.push(currentReplyComment);
        displayReplies();
        resetReplyCommentContainer();
        if (selectedAnnotation.annotationSelected) {
            document.getElementById('updateAnnotation').disabled = false;
        }
    }
    //Method to update reply comment of an annotation
    function updateEditReply() {
        selectedAnnotation.editReply = true;
        if (selectedAnnotation.editReply && currentEditCommentId) {
            var currentReplyComment = selectedAnnotation.replyComments.find(function (comment) { return comment.id === currentEditCommentId; });
            if (currentReplyComment) {
                currentReplyComment.author = selectedAnnotation.replyAuthor;
                currentReplyComment.note = selectedAnnotation.replyComment;
                currentReplyComment.state = selectedAnnotation.replyState;
                currentReplyComment.modifiedDate = formatCurrentDate(new Date(selectedAnnotation.replyModifiedDate));
            }
            else {
                console.log('Comment ID : ' + currentEditCommentId + ' is not found');
            }
            currentEditCommentId = "";
        }
        selectedAnnotation.editReply = false;
        displayReplies();
        resetReplyCommentContainer();
        if (selectedAnnotation.annotationSelected) {
            document.getElementById('updateAnnotation').disabled = false;
        }
    }
    
    //Function to reset reply comments container
    function resetReplyCommentContainer() {
        // Reset the reply fields
        selectedAnnotation.replyAuthor = 'Guest';
        replyAuthorElement.value = selectedAnnotation.replyAuthor;
        replyCommentElement.value = "";
        replyCommentElement.placeholder = "Reply Comment";
        selectedAnnotation.replyState = 'None';
        replyStateElement.value = selectedAnnotation.replyState;
        document.getElementById("updateReplyButton").style.display = "none";
        document.getElementById("addreplyButton").style.display = "block";
    }
    //Method to format replies container element
    function displayReplies() {
        var repliesContainer = document.getElementById('repliesContainer');
        document.getElementById('replyList').innerHTML = "Replies";
        document.getElementById('replyList').style.display = "block";
        repliesContainer.innerHTML = ``;
        if (selectedAnnotation.replyComments.length > 0) {
            selectedAnnotation.replyComments.forEach(function (comment) {
                var replyContainer = document.createElement('div');
                replyContainer.className = 'e-pv-reply-container';
                replyContainer.id = comment.id;
                replyContainer.innerHTML = `
                    <div class="e-pv-reply-icon e-pv-comment-icon e-pv-icon"></div>
                    <div class="e-pv-reply-main-container">
                        <div class="e-pv-reply-text">${comment.author} - ${comment.modifiedDate}</div>
                        <div class="e-pv-reply-text">${comment.note} &nbsp; ${comment.state !== 'None' ? comment.state : ''}</div>
                    </div>
                    <div class="e-pv-more-container">
                        <button class="e-control e-btn e-lib e-flat e-icon-btn context-menu-btn" data-id="${comment.id}" onmousedown="getCommentID('${comment.id}')"
                        onclick="openContextMenu(event)" id='contextmenutarget' style="padding: 5px 4px;">
                            <span class="e-icons e-more-vertical-1 e-btn-icon"></span>
                        </button>
                    </div>
                `;
                repliesContainer.appendChild(replyContainer);
                repliesContainer.style.display = "block";
            });
        }
        else {
            repliesContainer.style.display = "none";
            document.getElementById('replyList').style.display = "none";
        }
    }
 
    function openContextMenu(event) {
        document.getElementById('contextMenu').ej2_instances[0].open(event.clientY, event.clientX);
    }

    var currentEditCommentId;

    function getCommentID(commentId) {
        currentEditCommentId = commentId;
    }
    //Method to set the selected reply comment properties to reply container elements on editing
    function onReplyCommentEdit(commentId) {
        // Get the comment to edit
        selectedAnnotation.editReply = true;
        var comment;
        for (var i = 0; i < selectedAnnotation.replyComments.length; i++) {
            if (selectedAnnotation.replyComments[i].id === commentId) {
                comment = selectedAnnotation.replyComments[i];
            }
        }
        if (comment) {
            // Set the fields for editing
            selectedAnnotation.replyAuthor = comment.author;
            replyAuthorElement.value = comment.author;
            selectedAnnotation.replyComment = comment.note;
            replyCommentElement.value = comment.note;
            selectedAnnotation.replyState = comment.state;
            replyStateElement.value = comment.state;
            currentEditCommentId = commentId;
            document.getElementById("updateReplyButton").style.display = "block";
            document.getElementById("addreplyButton").style.display = "none";
        }
    }

    //Function to delete reply comments
    function onReplyCommentDelete(commentId) {
        // Remove the comment from the array
        var viewer = document.getElementById('pdfviewer').ej2_instances[0];
        var commentIndex = selectedAnnotation.replyComments.findIndex(function (comment) {
            return comment.id === commentId;
        });
        if (commentIndex !== -1) {
            selectedAnnotation.replyComments.splice(commentIndex, 1);
        }
        if (selectedAnnotation.replyComments.length === 0) {
            selectedAnnotation.isReply = false;
            replyElement.checked = selectedAnnotation.isReply;
            document.getElementById('checkedReplybox').style.display = "none";
        }
        // Update the displayed replies
        displayReplies();
        if (selectedAnnotation.annotationSelected) {
            document.getElementById('updateAnnotation').disabled = false;
        }
    }
    //Method to update the annotation properties
    function updateAnnotation() {
        var index = -1;
        var updatedAnnotation;
        var viewer = document.getElementById('pdfviewer').ej2_instances[0];
        for (var i = 0; i < viewer.annotationCollection.length; i++) {
            if (viewer.annotationCollection[i].annotationId === CurrentUpdateAnnotationID) {
                index = i;
                break;
            }
        }
        if (index != -1) {
            updatedAnnotation = updateAnnotationSettings(viewer.annotationCollection[index]);
        }
        viewer.annotation.editAnnotation(updatedAnnotation);
        document.getElementById('updateAnnotation').disabled = true;
    }
    //Method to set updated values to annotation
    function updateAnnotationSettings(currentannotation) {
        if (selectedAnnotation.annotationType === "Highlight" || selectedAnnotation.annotationType === "Underline" || selectedAnnotation.annotationType === "Strikethrough" || selectedAnnotation.annotationType === "Squiggly")
        {
            currentannotation.bounds = [];
            currentannotation.color = selectedAnnotation.fillColor ? (selectedAnnotation.fillColor.includes("rgba") ? rgbaStringToHex(selectedAnnotation.fillColor) : selectedAnnotation.fillColor) : "";
            if (selectedAnnotation.bounds.length <= 1) {
                currentannotation.bounds.push({
                    X: selectedAnnotation.x,
                    Y: selectedAnnotation.y,
                    Width: selectedAnnotation.width,
                    Height: selectedAnnotation.height,
                    Left: selectedAnnotation.x,
                    Top: selectedAnnotation.y
                });
            } else if (selectedAnnotation.bounds.length > 1) {
                for (var i = 0; i < selectedAnnotation.bounds.length; i++) {
                    currentannotation.bounds.push({
                        X: selectedAnnotation.bounds[i].X,
                        Y: selectedAnnotation.bounds[i].Y,
                        Width: selectedAnnotation.bounds[i].Width,
                        Height: selectedAnnotation.bounds[i].Height,
                        Left: selectedAnnotation.bounds[i].X,
                        Top: selectedAnnotation.bounds[i].Y
                    });
                }
            } else {
                currentannotation.bounds.X = selectedAnnotation.x;
                currentannotation.bounds.Y = selectedAnnotation.y;
                currentannotation.bounds.Width = selectedAnnotation.width;
                currentannotation.bounds.Height = selectedAnnotation.height;
                currentannotation.bounds.Left = selectedAnnotation.x;
                currentannotation.bounds.Top = selectedAnnotation.y;
            }
        } else if (selectedAnnotation.annotationType === "Ink") {
            currentannotation.bounds.width = selectedAnnotation.width;
            currentannotation.bounds.height = selectedAnnotation.height;
            currentannotation.bounds.x = selectedAnnotation.x;
            currentannotation.bounds.y = selectedAnnotation.y;
        } else if (
            selectedAnnotation.annotationType === "Arrow" ||
            selectedAnnotation.annotationType === "Line"
        ) {
            currentannotation.vertexPoints[0].x = selectedAnnotation.vertexX1;
            currentannotation.vertexPoints[0].y = selectedAnnotation.vertexY1;
            currentannotation.vertexPoints[1].x = selectedAnnotation.vertexX2;
            currentannotation.vertexPoints[1].y = selectedAnnotation.vertexY2;
            currentannotation.lineHeadStartStyle = selectedAnnotation.lineHeadStartStyle;
            currentannotation.lineHeadEndStyle = selectedAnnotation.lineHeadEndStyle;
        } else if (selectedAnnotation.annotationType === "Distance") {
            currentannotation.vertexPoints[0].x = selectedAnnotation.vertexX1;
            currentannotation.vertexPoints[0].y = selectedAnnotation.vertexY1;
            currentannotation.vertexPoints[1].x = selectedAnnotation.vertexX2;
            currentannotation.vertexPoints[1].y = selectedAnnotation.vertexY2;
            currentannotation.fillColor = selectedAnnotation.fillColor;
            currentannotation.leaderLength = selectedAnnotation.leaderLength;
        } else if (selectedAnnotation.annotationType === "FreeText") {
            currentannotation.bounds.width = selectedAnnotation.width;
            currentannotation.bounds.height = selectedAnnotation.height;
            currentannotation.bounds.left = selectedAnnotation.x;
            currentannotation.bounds.top = selectedAnnotation.y;
            currentannotation.bounds.x = selectedAnnotation.x;
            currentannotation.bounds.y = selectedAnnotation.y;
            currentannotation.dynamicText = selectedAnnotation.defaultText;
            if (selectedAnnotation.fontStyle === "Bold") {
                currentannotation.font.isBold = true;
                currentannotation.font.isStrikeout = false;
                currentannotation.font.isUnderline = false;
                currentannotation.font.isItalic = false;
            } else if (selectedAnnotation.fontStyle === "Italic") {
                currentannotation.font.isItalic = true;
                currentannotation.font.isStrikeout = false;
                currentannotation.font.isUnderline = false;
                currentannotation.font.isBold = false;
            } else if (selectedAnnotation.fontStyle === "Underline") {
                currentannotation.font.isUnderline = true;
                currentannotation.font.isStrikeout = false;
                currentannotation.font.isItalic = false;
                currentannotation.font.isBold = false;
            } else if (selectedAnnotation.fontStyle === "Strikethrough") {
                currentannotation.font.isStrikeout = true;
                currentannotation.font.isUnderline = false;
                currentannotation.font.isItalic = false;
                currentannotation.font.isBold = false;
            } else {
                currentannotation.font.isStrikeout = false;
                currentannotation.font.isUnderline = false;
                currentannotation.font.isItalic = false;
                currentannotation.font.isBold = false;
            }
            currentannotation.textAlign = selectedAnnotation.alignment;
            currentannotation.fontFamily = selectedAnnotation.fontFamily;
            currentannotation.fontSize = selectedAnnotation.fontSize;
            currentannotation.fontColor = selectedAnnotation.fontColor ? (selectedAnnotation.fontColor.includes("rgba") ? rgbaStringToHex(selectedAnnotation.fontColor) : selectedAnnotation.fontColor) : "";
        } else {
            currentannotation.bounds.width = selectedAnnotation.width;
            currentannotation.bounds.height = selectedAnnotation.height;
            currentannotation.bounds.left = selectedAnnotation.x;
            currentannotation.bounds.top = selectedAnnotation.y;
        }
        currentannotation.fillColor = selectedAnnotation.fillColor ? (selectedAnnotation.fillColor.includes("rgba") ? rgbaStringToHex(selectedAnnotation.fillColor) : selectedAnnotation.fillColor) : "";
        currentannotation.pageNumber = selectedAnnotation.pageNumber - 1;
        currentannotation.opacity = selectedAnnotation.opacity / 100;
        currentannotation.thickness = selectedAnnotation.thickness;
        currentannotation.strokeColor = selectedAnnotation.strokeColor ? (selectedAnnotation.strokeColor.includes("rgba") ? rgbaStringToHex(selectedAnnotation.strokeColor) : selectedAnnotation.strokeColor) : "";;
        currentannotation.lineHeadStartStyle = selectedAnnotation.lineHeadStartStyle;
        currentannotation.lineHeadEndStyle = selectedAnnotation.lineHeadEndStyle;
        //Condition for updating print property
        if (selectedAnnotation.isPrint) {
            currentannotation.isPrint = true;
            currentannotation.annotationSettings.isPrint = true;
        }
        else {
            currentannotation.isPrint = false;
            currentannotation.annotationSettings.isPrint = false;
        }
        //Condition for updating lock property
        if (selectedAnnotation.isLocked) {
            currentannotation.isLocked = true;
            currentannotation.annotationSettings.isLock = true;
            currentannotation.allowedInteractions = this.selectedAnnotation.allowedInteractions;
        }
        else {
            currentannotation.isLocked = false;
            currentannotation.annotationSettings.isLock = false;
        }
        if (selectedAnnotation.annotationType === "Line") {
            currentannotation.subType = 'Line';
        }
        else if (selectedAnnotation.annotationType === "Arrow") {
            currentannotation.subType = 'Arrow';
        }
        else if (selectedAnnotation.annotationType === "Distance") {
            currentannotation.subType = "Distance";
        }
        updateAnnotationComments(currentannotation);
        return currentannotation;
    }
    //Method to set the button and element interaction 
    function viewControl() {
        if (selectedAnnotation.annotationSelected) {
            annotationElement.enabled = false;
            pageNumberElement.enabled = false;
            inkDataElement.enabled = false;
            document.getElementById('addAnnotation').disabled = true;
            document.getElementById('updateAnnotation').disabled = true;
            document.getElementById('StampClicked').style.display = "none";
            document.getElementById('e-pv-fileuploader').style.display = "none";
        }
        else {
            annotationElement.enabled = true;
            pageNumberElement.enabled = true;
            inkDataElement.enabled = true;
            document.getElementById('addAnnotation').disabled = false;
            document.getElementById('updateAnnotation').disabled = true;
            if (selectedAnnotation.annotationType === "Stamp") {
                document.getElementById('StampClicked').style.display = "block";
            }
            if (selectedAnnotation.annotationType === "CustomStamp") {
                document.getElementById('e-pv-fileuploader').style.display = "block";
            }
        }
    }
    //Method to generate co-ordinate table for vertex points
    function generateTable() {
        const container = document.getElementById("coordinate-table");
        container.innerHTML = "";
        let tableHTML = "";

        // Check annotation type (Polygon, Perimeter, etc.)
        if (selectedAnnotation.annotationType === "Polygon" ||
            selectedAnnotation.annotationType === "Perimeter" ||
            selectedAnnotation.annotationType === "Area" ||
            selectedAnnotation.annotationType === "Volume") {

            if (selectedAnnotation.vertexPoints.length > 0) {
                tableHTML += '<div>';
                tableHTML += '<table class="inner-table coordinate-table vertex">';

                // Loop through the VertexPoints and create rows with 2 columns
                for (let i = 0; i < selectedAnnotation.vertexPoints.length; i++) {
                    if (i % 2 === 0) {
                        // Start a new row every two points
                        tableHTML += '<tr>';
                    }

                    // Add the X and Y value of the current point in a single cell
                    const point = selectedAnnotation.vertexPoints[i];
                    if (i % 2 === 0) {
                        tableHTML += `<td style="border-right: 1px solid #ddd;">X${i + 1} =${parseInt(point.x, 10)} &ensp; Y${i + 1} =${parseInt(point.y, 10)}</td>`;
                    } else {
                        // For the second point in the pair (i + 1), add it to the second column
                        const point2 = selectedAnnotation.vertexPoints[i];
                        tableHTML += `<td>X${i + 1} =${parseInt(point2.x, 10)} &ensp; Y${i + 1} =${parseInt(point2.y, 10)}</td>`;
                        tableHTML += '</tr>';
                    }
                }

                tableHTML += '</table>';
                tableHTML += '</div>';
            }
            if (selectedAnnotation.vertexPoints.length === 1) {
                document.getElementById("deleteVertex").disabled = true;
            } else {
                document.getElementById("deleteVertex").disabled = false;
            }
        }
        else {
            tableHTML += '<div>';
            tableHTML += '<table class="inner-table coordinate-table-bounds">';
            selectedAnnotation.bounds.forEach((bound, index) => {
                tableHTML += '<tr>';
                tableHTML += `<td style="width:400px">X${index + 1} = ${parseInt(bound.X,10)} &ensp; Y${index + 1} = ${parseInt(bound.Y,10)} &ensp; W${index + 1} = ${parseInt(bound.Width, 10)} &ensp; H${index + 1} = ${parseInt(bound.Height, 10)}</td>`;
                tableHTML += '</tr>';
            });
            tableHTML += '</table>';
            tableHTML += '</div>';
        }
        // Insert the generated table into the DOM
        container.innerHTML = tableHTML;
        container.style.display = "block";
        if (selectedAnnotation.bounds.length === 1) {
            document.getElementById("deleteBounds").disabled = true;
        } else {
            document.getElementById("deleteBounds").disabled = false;
        }
    }
    //Method to clear the coordinate-table 
    function clearTable() {
        // Select the table body element by its ID
        var tableBody = document.getElementById('coordinate-table');

        // Check if the table body exists
        if (tableBody) {
            tableBody.innerHTML = ''; // Clear all rows
            tableBody.style.display = 'none'; // Hide the table after deletion
        }
    }
    //Method to add bounds 
    function addBounds() {
        selectedAnnotation.bounds.push({ X: xPositionElement.value, Y: yPositionElement.value, Width: widthElement.value, Height: heightElement.value });
        generateTable();
        if (selectedAnnotation.annotationSelected) {
            document.getElementById('updateAnnotation').disabled = false;
        }
    }
    //Method to add vertex points 
    function addVertexPoints() {
        selectedAnnotation.vertexPoints.push({ x: xPositionElement.value, y: yPositionElement.value });
        generateTable();
        if (selectedAnnotation.annotationSelected) {
            document.getElementById('updateAnnotation').disabled = false;
        }
    }
    //Method to delete vertex points and bounds
    function deleteList() {
        if (selectedAnnotation.annotationType === "Polygon" ||
            selectedAnnotation.annotationType === "Perimeter" ||
            selectedAnnotation.annotationType === "Area" ||
            selectedAnnotation.annotationType === "Volume") {
            if (selectedAnnotation.vertexPoints.length > 1) {
                selectedAnnotation.vertexPoints.splice(selectedAnnotation.vertexPoints.length - 1, 1);
            }
        }
        else {
            if (selectedAnnotation.bounds.length > 1) {
                selectedAnnotation.bounds.splice(selectedAnnotation.bounds.length - 1, 1);
            }
        }
        generateTable();
        if (selectedAnnotation.annotationSelected) {
            document.getElementById('updateAnnotation').disabled = false;
        }
    }
    //Method to append edit and delete functions to context menu items 
    function contextMenuItemSelected(args) {
        switch (args.item.text) {
            case 'Edit':
                onReplyCommentEdit(currentEditCommentId);
                break;
            case 'Delete':
                onReplyCommentDelete(currentEditCommentId);
                break;
        }
    }

    var dropElement = document.getElementsByClassName('control-fluid')[0];
    //Method to clear upload element
    function onFileRemove() {
        selectedAnnotation.customStampImageSource = "@syncfusionLogo";
        document.getElementById("uploadedImage").src = "@Html.Raw(syncfusionLogo)";
        uploadElement.remove();
    }
    //Method to update annotation comments and reply comments 
    function updateAnnotationComments(currentAnnotation) {
        let isReplyChanged = false;
        currentAnnotation.commentType = "add";
        if (((!isNullOrUndefined(currentAnnotation.note) && (currentAnnotation.note !== selectedAnnotation.comment)) ||
            (!isNullOrUndefined(currentAnnotation.notes) && (currentAnnotation.notes !== selectedAnnotation.comment))) &&
            (currentAnnotation.comments && (currentAnnotation.comments.length > 0))) {

            currentAnnotation.commentType = "edit";
        }
        let calibrationType = currentAnnotation.indent ?? "";
        if (calibrationType !== "LineDimension" && calibrationType !== "PolyLineDimension" && calibrationType !== "PolygonDimension" &&
            calibrationType !== "PolygonRadius" && calibrationType !== "PolygonVolume") {

            if (!isNullOrUndefined(currentAnnotation.note) || ((currentAnnotation.shapeAnnotationType === "Ink" || currentAnnotation.shapeAnnotationType === "FreeText") && !currentAnnotation.note)) {
                currentAnnotation.note = selectedAnnotation.comment;
            }
            else if (!isNullOrUndefined(currentAnnotation.notes)) {
                currentAnnotation.notes = selectedAnnotation.comment;
            }
        }
        currentAnnotation.replyComment = [];
        if (!isNullOrUndefined(selectedAnnotation.replyComments) && (selectedAnnotation.replyComments.length > 0)) {
            if (selectedAnnotation.replyComments.length > currentAnnotation.comments?.length) {
                let diff = Number(selectedAnnotation.replyComments.length - currentAnnotation.comments.length);
                currentAnnotation.commentType = "add";
                for (let index = (selectedAnnotation.replyComments.length - diff); index < (selectedAnnotation.replyComments.length); index++) {
                    currentAnnotation.replyComment.push(selectedAnnotation.replyComments[index].note);
                }
            }
            else if (selectedAnnotation.replyComments.length === currentAnnotation.comments?.length) {
                selectedAnnotation.replyComments.forEach((value, index) => {
                    if (currentAnnotation.comments[index] && (value.note !== currentAnnotation.comments[index].note)) {
                        isReplyChanged = true;
                        currentAnnotation.commentType = 'edit';
                        currentAnnotation.commentId = currentAnnotation.comments[index].annotName;
                        currentAnnotation.editComment = value.note;
                    }
                    //currentAnnotation.replyComment.push(value.note);
                });
            }
        }
        
        if (!isReplyChanged) {
            currentAnnotation.commentId = null;
            currentAnnotation.editComment = null;
        }
    }
    function isNullOrUndefined(obj) {
        return (obj === null) || (obj === undefined);
    }
    //Method to convert pixel to point
    function convertPixelToPoint(number) {
        return (number * (72 / 96));
    }
    //Method to remove placeholder on focus
    function onCommentFocus(args) {
        args.event.target.placeholder = "";
    }
    function onCommentBlur(args) {
        if (args.value === "") {
            args.event.target.placeholder = "New Comment";
        }
    }
    function resetReplies() {
        selectedAnnotation.isReply = false;
        replyElement.checked = selectedAnnotation.isReply;
        selectedAnnotation.replyComments = [];
        document.getElementById('checkedReplybox').style.display = "none";
        document.getElementById('replyList').style.display = "none";
        document.getElementById('repliesContainer').style.display = "none";
    }
</script>


@section Title{
    <title>ASP.NET MVC PDF Viewer Programmatic Operations Example - Syncfusion Demos </title>
}
@section Header{
    <h1 class='sb-sample-text'>Example of Programmatic Operations in ASP.NET MVC PDF Viewer Control</h1>
}
